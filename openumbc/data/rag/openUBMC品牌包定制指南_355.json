{
    "topic_id": 355,
    "question": "openUBMC品牌包定制指南 - content: openUBMC品牌包定制指南\n本指南旨在指导如何进行品牌包配置及制作\n品牌包简介\n品牌包本质就是一个hpm包，通过固件升级的方式来实现定制化能力\n可以定制的内容主要包括以下几个部分：图片定制，网页风格定制，配置定制\n\n序号\n定制类别\n定制项\n文件\n属性\n\n1\n图片定制\n浏览器ICO\nfavicon.ico\n/\n\n2\n图片定制\n二维码\ncode1.png\n/\n\n3\n图片定制\n登录界面背景\nlogin.png\n/\n\n4\n图片定制\n登录界面图标\nlogin_logo.png\n/\n\n5\n图片定制\n主界面机型展示图片\nimg_01.png/img_02.png/img_03.png\n/\n\n6\n图片定制\n主界面左上角图片\nheader_logo.png\n/\n\n7\n风格定制\n主界面风格\nstyle_config.json\npageStyle\n\n8\n配置定制\n产品联系人\nweb_custom.xml\nsysContact\n\n9\n配置定制\n默认安全公告\nweb_custom.xml\ndBannerContent\n\n10\n配置定制\n预置证书Common Name\nweb_custom.xml\nPreSSLSeverCommonName\n\n11\n配置定制\n预置证书Organization Name\nweb_custom.xml\nPreSSLSeverOrgName\n\n12\n配置定制\n预置证书Country\nweb_custom.xml\nPreSSLSeverCountry\n\n13\n配置定制\n官网\nweb_custom.xml\nOfficalWeb\n\n14\n配置定制\n版权信息\nweb_custom.xml\nCopyright\n\n15\n配置定制\n技术支持网址\nweb_custom.xml\nSupportWeb\n\n16\n配置定制\n邮箱\nweb_custom.xml\nEmail\n\n17\n配置定制\n电话\nweb_custom.xml\nPhone\n\n18\n配置定制\n独立KVM\nweb_custom.xml\nDownloadKVMLink\n\n19\n配置定制\n二维码显示标志位(是否显示)\nweb_custom.xml\nDocSupportFlag\n\n20\n配置定制\nBMC软件名称\nweb_custom.xml\nSoftwareName\n\n21\n配置定制\n告警、事件描述\nweb_custom.xml\nCustomAlarmName\n\n22\n配置定制\n操作、运行、安全日志(BMA名称定制)\nweb_custom.xml\nCustomLogIbmaName\n\n23\n配置定制\nCLI界面命令提示符、日志(BMC名称定制)\nweb_custom.xml\nCustomLogIbmcName\n\n24\n配置定制\nredfish OEM厂商\nweb_custom.xml\nCustomManufacturer\n\n25\n配置定制\n语言\nweb_custom.xml\nLanguageSet\n\n26\n配置定制\n追加语言\nweb_custom.xml\nLanguageSetAppend\n\n27\n配置定制\nBMC主机名称\nweb_custom.xml\nHostName\n\n28\n配置定制\n客户名称(用于生效指定客户定制的特性)\nweb_custom.xml\nCustomer\n\n如何定制一个品牌包\n1.新建一个仓用户存放品牌定制文件\n品牌定制文件包括各种定制图片、配置文件web_custom.xml以及filelist.conf，定制图片名称需要与上述表格展示的文件名一致\n2.配置filelist.conf\n需要正确配置文件数量、文件名称和文件路径。其中文件路径和文件名称是固定的，不允许进行变更，FileNum的值需要与下列配置File的个数一致，具体配置参考下面示例\n[Basic]\nVersion=2.00\n\n[Filelist]\nFileNum=9\n\n[File0]\nName=code1.png\nPath=/data/opt/pme/web/htdocs/theme/custom/img\n\n[File1]\nName=favicon.ico\nPath=/data/opt/pme/web/htdocs\n\n[File2]\nName=web_custom.xml\nPath=/data/opt/pme/web/conf\n\n[File3]\nName=header_logo.png\nPath=/data/opt/pme/web/custom\n\n[File4]\nName=login.png\nPath=/data/opt/pme/web/custom\n\n[File5]\nName=login_logo.png\nPath=/data/opt/pme/web/custom\n\n[File6]\nName=img_01.png\nPath=/data/opt/pme/web/custom\n\n[File7]\nName=img_02.png\nPath=/data/opt/pme/web/custom\n\n[File8]\nName=img_03.png\nPath=/data/opt/pme/web/custom\n\n3.配置web_custom.xml\nweb_custom.xml负责配置各种属性，配置项含义如下，其中VALUE的内容需要替换为定制内容，不需要的配置项可以删除\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!-- 描述：目前官网、版权信息、独立KVM下载链接信息、文档二维码显示标志位在web中有使用 -->\n<CUSTOM_CONFIG>\n    <!-- 系统联系人 -->\n    <SysContact VALUE=\"CustomSysContact\" />\n\n    <!-- SSL证书预置信息，当前安装的SSL证书的签发者信息和预置信息一致时，认为当前SSL证书是预置证书，web会提醒用户安装新证书 -->\n    <PreSSLSeverCommonName VALUE=\"CustomCommonName\"/>\n    <PreSSLSeverOrgName VALUE=\"CustomOrgName\"/>\n    <PreSSLSeverCountry VALUE=\"Country\"/>\n\n    <!-- 官方网站 -->\n    <OfficalWeb VALUE=\"CustomOfficalWeb\"/>\n    <!-- 版权 -->\n    <Copyright VALUE=\"CustomCopyright\"/>\n    <!-- 支撑网站 -->\n    <SupportWeb VALUE=\"CustomSupportWeb\"/>\n    <!-- 邮件 -->\n    <Email VALUE=\"CustomEmail\"/>\n    <!-- 电话 -->\n    <Phone VALUE=\"CustomPhone\"/>\n    <!-- 独立KVM客户端下载链接 -->\n    <DownloadKVMLink VALUE=\"CustomDownloadKVMLink\"/>\n    <!-- 是否支持显示二维码 -->\n    <DocSupportFlag VALUE=\"CustomDocSupportFlag\"/>\n    <!-- 软件名称，用于自定义日志BMC名称和CLP提示符 -->\n    <SoftwareName VALUE=\"CustomSoftwareName\"/>\n    <!-- 自定义BMA名称 -->\n    <CustomLogIbmaName VALUE=\"CustomLogIbmaName\"/>\n    <!-- 与软件名称SoftwareName功能相同 -->\n    <CustomLogIbmcName VALUE=\"CustomLogIbmcName\"/>\n    <!-- 主机名 -->\n    <HostName VALUE=\"CustomHostName\"/>\n    <!-- 安全公告 -->\n    <dBannerContent VALUE=\"CustomdBannerContent\"/>\n    <Customer VALUE=\"CustomerName\"/>\n</CUSTOM_CONFIG>\n\n4.配置manifest仓中产品对应的manifest.yml\n(1)新建编码，如WBD\n(2)确定好包名package_name，如wbd/wbd_output.zip\n(3)确定好构建类型build_type，如release\n(4)开始配置品牌包相关配置，配置格式如下示例\nmanufacture:\n    WBD:\n        # package_name为品牌包存放路径与品牌包名称\n        pack_age_name: wbd/wbd_output.zip\n        build_type: release\n        wbd_hpms:\n            # repo为存放品牌包定制文件的仓库地址，需要填写https下载的地址\n            - repo: https://test.git\n              # tag为存放定制文件的分支tag号\n              tag: 0.0.0\n              files:\n                # 根据品牌定制文件存放路径修改file的路径，但是dst路径不可修改，均为\"wbd_up_file/文件名\"的格式，如下示例\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/favicon.ico\n                dst: wbd_up_file/favicon.ico\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/login_logo.png\n                dst: wbd_up_file/login_logo.png\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/header_logo.png\n                dst: wbd_up_file/header_logo.png\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/filelist.conf\n                dst: wbd_up_file/filelist.conf\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/web_custom.xml\n                dst: wbd_up_file/web_custom.xml\n                # 下列文件都是制作品牌包必须文件，路径固定，不可删除\n                - file: /usr/share/bmcgo/wbd-packet/beforeaction.sh\n                - file: /usr/share/bmcgo/wbd-packet/afteraction_remove_busctl.sh\n                dst: afteraction.sh\n                - file: /usr/share/bmcgo/wbd-packet/CfgFileList.conf\n                - file: /usr/share/bmcgo/wbd-packet/firstboot.sh\n                - file: /usr/share/bmcgo/wbd-packet/hpm_wbd.config\n                - file: /usr/share/bmcgo/wbd-packet/packetwbd.sh\n                - file: /usr/share/bmcgo/wbd-packet/update.cfg\n        # dst为最后制作出来的品牌包名称\n        files:\n          - file: ${work_out}/wbd_hpm1.hpm\n            dst: WBD-image.hpm\n            verify:\n              - pss\n\n(5)确认manifest配置的品牌定制文件个数与filelist.conf中文件个数一致，不一致会导致升级品牌包失败\n5.在manifest仓的build目录执行构建命令\nbmcgo publish -z WBD -b TaiShan200_2280v2\n其中-z的参数为品牌包的编码，-b的参数为机型\n\n取包地址: manifest/output/packet/wbd/wbd_output.zip\n6.升级品牌包\n进入固件升级->固件更新->升级文件，进行品牌包升级，如果配置了Customer字段则在升级完成后会自动重启，其他场景无需重启即可生效\nlinks: #p-632-openubmc-1, #p-632-h-2, #p-632-h-3",
    "topic_user_name": "HuoJianCong",
    "best_answer_url": "/t/topic/355/3",
    "reply_posts": [
        {
            "user_name": "xuhaijun",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/355/2",
            "text": "白牌包的files记录需要打包的文件，如果file是相对路径的，会去repo仓提取文件。\n从/usr/share/bmcgo/wbd-package/目录复制的文件一般情况下原样保持即可，如果确要修改的，请放在repo仓中记录。\n              repo: https://test.git\n              # tag为存放定制文件的分支tag号\n              tag: 0.0.0\n              files:\n                # 以下示例是从repo仓提取文件customization/Server/Kunpeng/TaiShan200_2280v2/WBD/favicon.ico并复制到wbd_up_file/favicon.ico。\n                - file: customization/Server/Kunpeng/TaiShan200_2280v2/WBD/favicon.ico\n                  dst: wbd_up_file/favicon.ico\n                # 以下示例是从bmcgo工具打包目录复制beforeaction.sh\n                - file: /usr/share/bmcgo/wbd-packet/beforeaction.sh"
        },
        {
            "user_name": "黎乐轩",
            "topic_closed": true,
            "is_solution": true,
            "post_url": "/t/topic/355/3",
            "text": "content: 制作清白牌包的方法\n定制之后，如果需要恢复到原来的配置，需要升级清白牌包。实际上，清白牌包也是一个白牌包，只是里面的配置是默认配置。所以如果需要恢复到原来的配置，只需再出一个恢复到默认配置的白牌包即可。\nweb_custom.xml默认配置举例：\n\t<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\t<!-- 描述：目前官网、版权信息、独立KVM下载链接信息、文档二维码显示标志位在web中有使用 -->\n\t<CUSTOM_CONFIG>\n\t\t<!-- 官方网址 -->\n\t\t<OfficalWeb VALUE=\"http://enterprise.huawei.com/\" />\n\t\t<!-- 技术支持网址 -->\n\t\t<SupportWeb VALUE=\"http://support.huawei.com/\" />\n\t\t<!-- 邮箱 -->\n\t\t<Email VALUE=\"support_e@huawei.com\" />\n\t\t<!-- 电话 -->\n\t\t<Phone VALUE=\"400-822-9999\" />\n\t\t<!-- 版权信息 -->\n\t\t<Copyright VALUE=\"Huawei Technologies Co., Ltd. 2004-2025. All rights reserved.\" />\n\t\t<!-- 独立KVM下载链接信息-->\n\t\t<DownloadKVMLink VALUE=\"http://support.huawei.com/onlinetoolsweb/itexpress/kvmclient/\" />\n\t\t<!-- 版权信息(示例：VALUE=\"en,zh\" 对应支持英中文) -->\n\t\t<LanguageSet VALUE=\"en,zh,ja,fr,ru\" />\n\t\t<!-- 产品信息联系人(示例：VALUE=\"http://enterprise.huawei.com/\") -->\n\t\t<sysContact VALUE=\"http://enterprise.huawei.com/\" />\n\t\t<!-- 文档二维码显示标志位(示例：VALUE=\"1\" 值为“0”,“1”，其它值默认为“0”)-->\n\t\t<DocSupportFlag VALUE=\"1\" />\n\t\t<!-- 软件名称(示例：VALUE=\"iBMC\") -->\n\t\t<SoftwareName VALUE=\"iBMC\" />\n\t\t<!-- Redfish OEM厂商(示例：VALUE=\"Huawei\" 对应支持英中文) -->\n\t\t<CustomManufacturer VALUE=\"Huawei\" />\n\t\t<!-- 告警/事件描述(示例：VALUE=\"iBMC\")-->\n\t\t<CustomAlarmName VALUE=\"iBMC\" />\n\t\t<!-- 操作/运行/安全日志(示例：VALUE=\"iBMA\")-->\n\t\t<CustomLogIbmaName VALUE=\"iBMA\" />\n\t\t<!-- 操作/运行/安全日志(示例：VALUE=\"iBMC\") CLI界面命令提示符-->\n\t\t<CustomLogIbmcName VALUE=\"iBMC\" />\n\t\t<!--安全公告(示例：VALUE=\"安全公告\" )-->\n\t\t<dBannerContent VALUE=\"WARNING! This system is PRIVATE and PROPRIETARY and may only be accessed by authorized users. Unauthorized use of the system is prohibited. The owner, or its agents, may monitor any activity or communication on the system. The owner, or its agents, may retrieve any information stored within the system. By accessing and using the system, you are consenting to such monitoring and information retrieval for law enforcement and other purposes.\"/>\n\t</CUSTOM_CONFIG>\n\n图片文件等恢复默认，需要配置filelist.conf，把原来的Name配置成CLEAR_ALL, 然后在创建一个空文件，名称为CLEAR_ALL即可。注意在manifest配置的的时候，files中的配置需要包含这个CLEAR_ALL文件。升级白牌包时，遇到CLEAR_ALL配置，就会删除对应路径下的文件\nfilelist.conf配置举例\n#white branding file list\n\n[Basic]\nVersion=2.01\n\n[Filelist]\nFileNum=8\n\n[File0]\nName=code1.png\nPath=/data/opt/pme/web/htdocs/theme/custom/img\n\n[File1]\nName=favicon.ico\nPath=/data/opt/pme/web/htdocs\n\n[File2]\nName=logo.jpg\nPath=/data/opt/pme/web/htdocs/bmc/resources/images/cmn\n\n[File3]\nName=CustomizeSensor.xml\nPath=/data/opt/pme/conf/oem/profile\n\n[File4]\nName=CLEAR_ALL\nPath=/data/opt/pme/conf/oem/profile\n\n[File5]\nName=CLEAR_ALL\nPath=/data/opt/pme/web/htdocs/theme/custom/img\n\n[File6]\nName=web_custom.xml\nPath=/data/opt/pme/web/conf\n\n[File7]\nName=CLEAR_ALL\nPath=/data/opt/pme/web/custom\nlinks: #p-1633-h-1"
        },
        {
            "user_name": "He wei",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/355/4",
            "text": "既然按照指导文档会出现失败，麻烦能更新下文档吗"
        },
        {
            "user_name": "张雨博",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/355/5",
            "text": "有具体错误案例吗"
        },
        {
            "user_name": "He wei",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/355/6",
            "text": "content: 白牌包升级成功但是logo未成功替换 交流互助区\n\n    仍未解决，环境上无/opt/bmc/web/htdocs/extern/custom路径 \n [image]\n[image]\nlinks: https://discuss.openubmc.cn/t/topic/1217/3, /c/42-category/42, https://discuss.openubmc.cn/uploads/default/original/1X/16acaba372fedbf950750521e827b7da79638517.png, https://discuss.openubmc.cn/uploads/default/original/1X/4762c33f20879c664ec669186fe23504d9951756.png"
        },
        {
            "user_name": "LiJiang",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/355/7",
            "text": "content: 见社区issue, 已经在manifest修复合入。\n手动解决方案：\n参考PR 修改。\nlinks: https://gitcode.com/openUBMC/manifest/issues/32, https://gitcode.com/openUBMC/manifest/pull/46/diffs"
        }
    ]
}