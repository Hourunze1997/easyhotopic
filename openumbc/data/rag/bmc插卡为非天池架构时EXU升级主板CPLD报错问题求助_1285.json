{
    "topic_id": 1285,
    "question": "bmc插卡为非天池架构时，EXU升级主板CPLD报错问题求助 - content: 背景：\n1、非BMC插卡方案，1711芯片集成在扩展板上，使用的是原V2 cpld那套方案，没有使用SMC；\n2、主板使用的是华为的主板，主板CSR文件内配置了SMC；\n问题：\n升级主板CPLD时，uid校验和签名都通过，最后出现如下错误日志：\n\n2001-01-02 07:34:34.046946 general_hardware NOTICE: fw_init.lua(163): get fw version 0.12\n2001-01-02 07:34:34.049200 general_hardware NOTICE: fw_upgrade.lua(95): [cpld]get verion[0.12]\n2001-01-02 07:34:34.052610 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: DIFF_PREPARE → COMMON_PREPARE, 7\n2001-01-02 07:34:34.154188 firmware_mgmt NOTICE: action.lua(89): public prepare action start\n2001-01-02 07:34:34.215180 firmware_mgmt NOTICE: worker: start action in worker\n2001-01-02 07:34:34.286244 firmware_mgmt NOTICE: worker: execute before action script successfully\n2001-01-02 07:34:35.215290 firmware_mgmt NOTICE: action.lua(95): public prepare action end\n2001-01-02 07:34:35.215744 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: COMMON_PREPARE → PROCESS, 15\n2001-01-02 07:34:35.317595 firmware_mgmt NOTICE: control.lua(158): sys_id=1, fw_type=BP_Cpld, filename=/dev/shm/upgrade/3136381404/Firmware1\n2001-01-02 07:34:35.321760 general_hardware NOTICE: upgrade_subject.lua(88): [on_upgrade_process] start upgrade BP_Cpld\n2001-01-02 07:34:35.323330 general_hardware NOTICE: signal.lua(121): [cpld]Start the system[1] BP_Cpld upgrade process phase\n2001-01-02 07:34:35.423283 general_hardware NOTICE: upgrade_subject.lua(95): [on_upgrade_process] end upgrade BP_Cpld\n2001-01-02 07:34:35.424214 general_hardware NOTICE: fw_cfgs.lua(70): check fw uid(00000001020302068053) id(255) id_ex(4294967295) exist success\n2001-01-02 07:34:35.424537 general_hardware NOTICE: process.lua(38): cpld fw matched, system_id = 1, fw.uid = 00000001020302068053, fw.csr.Name = BCU_CPLD1\n2001-01-02 07:34:35.649882 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld01.svf) failed!\n2001-01-02 07:34:35.650751 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid01.svf) failed!\n2001-01-02 07:34:35.745563 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld02.svf) failed!\n2001-01-02 07:34:35.746547 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid02.svf) failed!\n2001-01-02 07:34:35.827823 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld03.svf) failed!\n2001-01-02 07:34:35.828842 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid03.svf) failed!\n2001-01-02 07:34:35.830540 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld04.svf) failed!\n2001-01-02 07:34:35.831404 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid04.svf) failed!\n2001-01-02 07:34:35.831954 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld05.svf) failed!\n2001-01-02 07:34:35.832460 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid05.svf) failed!\n2001-01-02 07:34:35.832973 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld06.svf) failed!\n2001-01-02 07:34:35.833669 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid06.svf) failed!\n2001-01-02 07:34:35.868101 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld07.svf) failed!\n2001-01-02 07:34:35.868684 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid07.svf) failed!\n2001-01-02 07:34:35.923183 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld08.svf) failed!\n2001-01-02 07:34:35.923871 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid08.svf) failed!\n2001-01-02 07:34:35.971664 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld09.svf) failed!\n2001-01-02 07:34:35.972417 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid09.svf) failed!\n2001-01-02 07:34:35.972886 general_hardware NOTICE: process.lua(295): [cpld]get cpld packages successful\n2001-01-02 07:34:36.127907 firmware_mgmt ERROR: control.lua(406): Upgrade BP_Cpld process failed, ret=-1\n2001-01-02 07:34:36.128195 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: PROCESS → COMMON_FINISH, 95\n2001-01-02 07:34:36.126269 general_hardware ERROR: signal.lua(133): [cpld] process upgrade failed, error: BMC.Error.Unknow: ./opt/bmc/libmc/lualib/mc/context.lua:185: ./opt/bmc/libmc/lualib/mc/signal.lua:257: ./opt/bmc/apps/hwproxy/lualib/hwproxy_objects/app_bus.lua:104: …bmc/apps/hwproxy/lualib/hwproxy_objects/work_objects.lua:74: chip: Smc_CpuBrdSMC_010101, bus: I2c_4, read failed: smc.lua:89: request error, opcode not supported, SMC completion code: 1\n2001-01-02 07:34:36.218339 firmware_mgmt NOTICE: control.lua(110): wait_msg_result stage=COMMON_FINISH, timeout=7200S, loop=8\n2001-01-02 07:34:36.218648 firmware_mgmt NOTICE: info_mgmt.lua(222): info_key(1BP_Cpld) upgrade failed, set_stage: COMMON_FINISH → COMPLETED\n2001-01-02 07:34:36.484610 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: COMPLETED → COMPLETED, 100\n2001-01-02 07:34:36.485159 firmware_mgmt ERROR: task_service.lua(83): Update task failed, task_id: 3136381404, res: -9\n\n和另一位同学出现timeout不同，我这边错误日志中打印了：Smc_CpuBrdSMC_010101, bus: I2c_4, read failed，怀疑跟I2C链路配置有关。\n想求助一下：\n1、上方报错是否跟I2C链路配置有关？\n2、针对非SMC方案的EXU和BCU相连，BCU铆接器传下来的I2C下挂载的SMC究竟该如何配置？我按下图配置是否正确？\n下图是当前项目上EXU和BCU在I2C拓扑上的部分关系（hisport未画出，该配置下，主板上的电压、温度传感器的信息都能拿到）。\nimage965×439 9.89 KB\nlinks: https://discuss.openubmc.cn/uploads/default/original/2X/5/5df5c1b06cd2a0d264dc866e19b1d4a051598924.png",
    "topic_user_name": "Kun Lun Lizhuang",
    "best_answer_url": "/t/topic/1285/4",
    "reply_posts": [
        {
            "user_name": "Kun Lun Lizhuang",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/1285/2",
            "text": "Smc_ExpBoardSMC，用于BCU从EXU那边捞取信息或给BMC发命令，而EXU没有SMC，因此这个需要修改为CPLD那套，BCU中使用Smc_ExpBoardSMC的地方都要换一下。"
        },
        {
            "user_name": "Kun Lun Lizhuang",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/1285/3",
            "text": "content: 修改后再升级，I2C报错没有了，但出现了如下报错：\n\n2000-01-01 10:05:00.272353 product_mgmt NOTICE: upgrade_mgmt.lua(72): [WBD] start finishing upgrade\n2000-01-01 10:05:02.315919 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1WhiteBranding) upgrade set_stage: DIFF_FINISH → CLEAR, 95\n2000-01-01 10:05:02.371051 firmware_mgmt NOTICE: control.lua(110): wait_msg_result stage=CLEAR, timeout=600S, loop=20\n2000-01-01 10:05:02.371278 firmware_mgmt NOTICE: control.lua(216): Upgrade 1WhiteBranding completely, pre_version=\n2000-01-01 10:05:02.423129 product_mgmt NOTICE: upgrade_mgmt.lua(75): [WBD] complete finishing upgrade, ret=0\n2000-01-01 10:05:02.604074 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1WhiteBranding) upgrade set_stage: CLEAR → COMPLETED, 100\n2000-01-01 10:05:02.702244 firmware_mgmt NOTICE: active_fructl.lua(95): get host type is Singlehost\n2000-01-01 10:05:02.703627 firmware_mgmt NOTICE: active_single_host_fructrl.lua(61): active_single_host_fructrl fructrl get power status\n2000-01-01 10:05:02.709993 firmware_mgmt NOTICE: state_simple_upgrading.lua(87): simple upgraded, current active mode is:nil, wait restart seconds:30000\n2000-01-01 10:05:02.723107 firmware_mgmt NOTICE: init.lua(33): update status to FS_IDLE.\n2000-01-01 10:05:38.932609 web_backend NOTICE: init.lua(98): upload content length:number 1379892, remaining capacity space:number 134156288\n2000-01-01 10:05:39.040172 general_hardware INFO: cpu_board.lua(33): [BCU]get BMC startup completed flag 0 [repeated 141 times in 302s from 2000-01-01 10:00:37.469763 to 2000-01-01 10:05:39.040172]\n2000-01-01 10:05:39.556764 firmware_mgmt NOTICE: active_fructl.lua(95): get host type is Singlehost\n2000-01-01 10:05:39.557161 firmware_mgmt NOTICE: utils.lua(35): The file path is local.\n2000-01-01 10:05:39.565215 firmware_mgmt NOTICE: init.lua(33): update status to FS_SIMPLE_UPGRADING.\n2000-01-01 10:05:39.582455 firmware_mgmt NOTICE: task_service.lua(49): task create success, task id: 2689589211\n2000-01-01 10:05:39.638208 firmware_mgmt NOTICE: file_transfer.lua(145): start to move file [BC83AMDE.signed.hpm] from tmp to shm\n2000-01-01 10:05:39.702201 firmware_mgmt NOTICE: file_transfer.lua(150): move_file_s ok:true, err:0\n2000-01-01 10:05:39.814021 firmware_mgmt NOTICE: validate_sign.lua(174): verify signature successfully\n2000-01-01 10:05:39.814607 firmware_mgmt NOTICE: action.lua(37): Validate signature successfully\n2000-01-01 10:05:39.985698 firmware_mgmt NOTICE: hpm_package.lua(488): parse cfg file successfully, Version:1.0 FileNum:2\n2000-01-01 10:05:39.986048 firmware_mgmt NOTICE: hpm_package.lua(444): get obj table: 0x08225810f068 for Id=24_1\n2000-01-01 10:05:39.987184 firmware_mgmt NOTICE: hpm_package.lua(413): System product info:ProductId(0), ProductVendorID(0xffffffff), ProductUniqueID(0x10307bf00)\n2000-01-01 10:05:39.987391 firmware_mgmt NOTICE: hpm_package.lua(327): check product id successfully\n2000-01-01 10:05:40.005593 firmware_mgmt NOTICE: hpm_package.lua(395): cfg-BoardIDList(65535) match all devices\n2000-01-01 10:05:40.005810 firmware_mgmt NOTICE: hpm_package.lua(437): get obj table: 0x08225810f068 for Id=24_1\n2000-01-01 10:05:40.006057 firmware_mgmt NOTICE: hpm_package.lua(459): hard_revision:0, soft_revision:0\n2000-01-01 10:05:40.006210 firmware_mgmt NOTICE: hpm_package.lua(472): revision number check successfully. Target revision=(0, 0) and hpm revision=nil\n2000-01-01 10:05:40.039293 firmware_mgmt NOTICE: action.lua(47): Parse hpm package successfully\n2000-01-01 10:05:40.039608 firmware_mgmt NOTICE: control.lua(247): upgrade_task file_name=BC83AMDE.signed.hpm, FirmwareType=BP_Cpld, fw_num=1, UniqueIDList=nil, sys_id=1\n2000-01-01 10:05:40.131670 firmware_mgmt NOTICE: info_mgmt.lua(73): create_info: info_key=1BP_Cpld, FirmwareType=BP_Cpld, task_id=2689589211\n2000-01-01 10:05:40.235280 firmware_mgmt NOTICE: action.lua(85): public initialize action\n2000-01-01 10:05:40.235566 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: INITIALIZE → DIFF_PREPARE, 5\n2000-01-01 10:05:40.341092 general_hardware NOTICE: upgrade_subject.lua(63): [on_upgrade_prepare] firmware_type:BP_Cpld cur_firmware_type:BP_Cpld\n2000-01-01 10:05:40.341423 general_hardware NOTICE: upgrade_subject.lua(71): [on_upgrade_prepare] start upgrade BP_Cpld\n2000-01-01 10:05:40.341696 general_hardware NOTICE: signal.lua(100): [cpld]Start the system[1] BP_Cpld upgrade prepare phase\n2000-01-01 10:05:40.447501 general_hardware NOTICE: upgrade_subject.lua(78): [on_upgrade_prepare] end upgrade BP_Cpld\n2000-01-01 10:05:40.447880 general_hardware INFO: fw_cfgs.lua(85): get cfg path[/dev/shm/upgrade/2689589211/update.cfg]\n2000-01-01 10:05:40.451443 general_hardware INFO: fw_cfgs.lua(100): get Firmware1\n2000-01-01 10:05:40.452667 general_hardware NOTICE: fw_upgrade.lua(118): [cpld]get cpld_valid :nil\n2000-01-01 10:05:40.452902 general_hardware NOTICE: fw_upgrade.lua(53): cpld cold upgrade, upgrade list = 1, 2, 3,\n2000-01-01 10:05:40.453749 general_hardware NOTICE: fw_cfgs.lua(70): check fw uid(00000001020302068053) id(255) id_ex(4294967295) exist success\n2000-01-01 10:05:40.762382 general_hardware NOTICE: fw_init.lua(165): get fw version 0.12\n2000-01-01 10:05:40.762678 general_hardware NOTICE: fw_upgrade.lua(95): [cpld]get verion[0.12]\n2000-01-01 10:05:40.764714 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: DIFF_PREPARE → COMMON_PREPARE, 7\n2000-01-01 10:05:40.839912 firmware_mgmt NOTICE: action.lua(89): public prepare action start\n2000-01-01 10:05:40.899894 firmware_mgmt NOTICE: worker: start action in worker\n2000-01-01 10:05:40.979352 firmware_mgmt NOTICE: worker: execute before action script successfully\n2000-01-01 10:05:41.027407 power_strategy NOTICE: power_strategy_utils.lua(89): Time difference(11001), update power monitor last tick(946692341026)\n2000-01-01 10:05:41.896123 firmware_mgmt NOTICE: action.lua(95): public prepare action end\n2000-01-01 10:05:41.896400 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: COMMON_PREPARE → PROCESS, 15\n2000-01-01 10:05:41.996534 firmware_mgmt NOTICE: control.lua(158): sys_id=1, fw_type=BP_Cpld, filename=/dev/shm/upgrade/2689589211/Firmware1\n2000-01-01 10:05:42.000089 general_hardware NOTICE: upgrade_subject.lua(88): [on_upgrade_process] start upgrade BP_Cpld\n2000-01-01 10:05:42.000405 general_hardware NOTICE: signal.lua(121): [cpld]Start the system[1] BP_Cpld upgrade process phase\n2000-01-01 10:05:42.108834 general_hardware NOTICE: upgrade_subject.lua(95): [on_upgrade_process] end upgrade BP_Cpld\n2000-01-01 10:05:42.109348 general_hardware ERROR: process.lua(36): [–lz–]system_id = 1, fw.uid:00000001010302044492, fw.csr.Name = EXU_CPLD\n2000-01-01 10:05:42.109822 general_hardware ERROR: process.lua(36): [–lz–]system_id = 1, fw.uid:, fw.csr.Name = BCU_CPLD2\n2000-01-01 10:05:42.110241 general_hardware ERROR: process.lua(36): [–lz–]system_id = 1, fw.uid:00000001020302068053, fw.csr.Name = BCU_CPLD1\n2000-01-01 10:05:42.110513 general_hardware NOTICE: fw_cfgs.lua(70): check fw uid(00000001020302068053) id(255) id_ex(4294967295) exist success\n2000-01-01 10:05:42.110729 general_hardware NOTICE: process.lua(39): cpld fw matched, system_id = 1, fw.uid = 00000001020302068053, fw.csr.Name = BCU_CPLD1\n2000-01-01 10:05:42.110993 general_hardware ERROR: process.lua(36): [–lz–]system_id = 1, fw.uid:, fw.csr.Name = BCU_CPLD3\n2000-01-01 10:05:42.385660 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld01.svf) failed!\n2000-01-01 10:05:42.387656 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid01.svf) failed!\n2000-01-01 10:05:42.447169 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld02.svf) failed!\n2000-01-01 10:05:42.448218 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid02.svf) failed!\n2000-01-01 10:05:42.531563 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld03.svf) failed!\n2000-01-01 10:05:42.533333 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid03.svf) failed!\n2000-01-01 10:05:42.534246 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld04.svf) failed!\n2000-01-01 10:05:42.535296 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid04.svf) failed!\n2000-01-01 10:05:42.536186 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld05.svf) failed!\n2000-01-01 10:05:42.537090 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid05.svf) failed!\n2000-01-01 10:05:42.538274 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld06.svf) failed!\n2000-01-01 10:05:42.539206 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid06.svf) failed!\n2000-01-01 10:05:42.582080 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld07.svf) failed!\n2000-01-01 10:05:42.583310 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid07.svf) failed!\n2000-01-01 10:05:42.628391 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld08.svf) failed!\n2000-01-01 10:05:42.629080 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid08.svf) failed!\n2000-01-01 10:05:42.652461 hardware ERROR: tar.c(664): __extract_file: lchown on file(cpld09.svf) failed!\n2000-01-01 10:05:42.653522 hardware ERROR: tar.c(664): __extract_file: lchown on file(valid09.svf) failed!\n2000-01-01 10:05:42.654438 general_hardware NOTICE: process.lua(299): [cpld]get cpld packages successful\n2000-01-01 10:05:42.655283 general_hardware INFO: fw_init.lua(135): [–lz–001]firmware_route value[0]\n2000-01-01 10:05:42.655968 general_hardware ERROR: process.lua(304): [–lz–][cpld]fw:table: 0x06d25147e4e8, cfg:table: 0x06d25172ab20, release_path:/dev/shm/upgrade/2689589211/, upgrade_list:table: 0x06d25171a908, hot_upgrade:false\n2000-01-01 10:05:42.656751 general_hardware NOTICE: process.lua(203): [cpld]load_cpld_multi_supplier_mode,cfg.supplier_mode:3\n2000-01-01 10:05:42.657436 general_hardware ERROR: process.lua(204): [–lz–][cpld] logic_fw:table: 0x06d25147e4e8, cfg:table: 0x06d25172ab20, file_path:/dev/shm/upgrade/2689589211/, upgrade_list:table: 0x06d25171a908, hot_upgrade:false\n2000-01-01 10:05:42.658072 general_hardware NOTICE: process.lua(178): [–lz–][cpld]chip_info:table: 0x06d251465e08\n2000-01-01 10:05:42.849294 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:42.849571 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d251701130, len:0, id_list[1]:nil\n2000-01-01 10:05:43.905929 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:43.906546 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2516ab6c8, len:0, id_list[1]:nil\n2000-01-01 10:05:44.961513 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:44.969255 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d251649010, len:0, id_list[1]:nil\n2000-01-01 10:05:46.016522 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:46.016712 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2515a0330, len:0, id_list[1]:nil\n2000-01-01 10:05:47.074284 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:47.075278 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2516d9f18, len:0, id_list[1]:nil\n2000-01-01 10:05:48.317791 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:48.320801 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d251738008, len:0, id_list[1]:nil\n2000-01-01 10:05:48.560271 power_strategy ERROR: power_strategy_utils.lua(89): Unhealthy power monitor status\n2000-01-01 10:05:49.374530 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:49.375301 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2516ef410, len:0, id_list[1]:nil\n2000-01-01 10:05:50.617505 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:50.618068 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2516d2a68, len:0, id_list[1]:nil\n2000-01-01 10:05:51.860768 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:51.861212 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d2513dbec8, len:0, id_list[1]:nil\n2000-01-01 10:05:53.100868 general_hardware ERROR: drivers_api.lua(36): [–lz–1] ok  :true\n2000-01-01 10:05:53.102773 general_hardware ERROR: drivers_api.lua(37): [–lz–2] ok  :true, id_list:table: 0x06d251634b50, len:0, id_list[1]:nil\n2000-01-01 10:05:54.097569 general_hardware NOTICE: process.lua(181): [cpld]get cpld device info failed\n2000-01-01 10:05:54.102923 general_hardware ERROR: process.lua(221): [–lz–][jtag cpld upgrade] upgrade_ret:-1, ok:true\n2000-01-01 10:05:54.104024 general_hardware ERROR: process.lua(306): [–lz–][cpld]fw.name:CpuBoard1 CPLD1, upgrade_list:table: 0x06d25171a908, one_fw_ret:-1\n2000-01-01 10:05:54.109566 general_hardware INFO: fw_init.lua(121): [–lz–000]firmware_route value[0]\n2000-01-01 10:05:54.112194 firmware_mgmt ERROR: control.lua(406): Upgrade BP_Cpld process failed, ret=-1\n2000-01-01 10:05:54.112453 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: PROCESS → COMMON_FINISH, 95\n2000-01-01 10:05:54.163964 firmware_mgmt NOTICE: control.lua(110): wait_msg_result stage=COMMON_FINISH, timeout=7200S, loop=120\n2000-01-01 10:05:54.164214 firmware_mgmt NOTICE: info_mgmt.lua(222): info_key(1BP_Cpld) upgrade failed, set_stage: COMMON_FINISH → COMPLETED\n2000-01-01 10:05:54.444380 firmware_mgmt NOTICE: info_mgmt.lua(171): info_key(1BP_Cpld) upgrade set_stage: COMPLETED → COMPLETED, 100\n2000-01-01 10:05:54.444787 firmware_mgmt ERROR: task_service.lua(83): Update task failed, task_id: 2689589211, res: -9\n2000-01-01 10:05:54.445908 firmware_mgmt NOTICE: active_fructl.lua(95): get host type is Singlehost\n2000-01-01 10:05:54.446164 firmware_mgmt NOTICE: active_single_host_fructrl.lua(61): active_single_host_fructrl fructrl get power status\n2000-01-01 10:05:54.449410 firmware_mgmt NOTICE: state_simple_upgrading.lua(87): simple upgraded, current active mode is:nil, wait restart seconds:30000\n2000-01-01 10:05:54.464606 firmware_mgmt NOTICE: init.lua(33): update status to FS_IDLE.\n\n其中，GetChipIdcode获取Jtag链上所有器件的IDCODE长度为空（#id_list），但GetChipIdcode函数内部如何实现的不清楚\nimage995×170 15.6 KB\nlinks: https://discuss.openubmc.cn/uploads/default/original/2X/c/c4fed69f6be7762988d89a32511514d0ec26d27d.png"
        },
        {
            "user_name": "Kun Lun Lizhuang",
            "topic_closed": true,
            "is_solution": true,
            "post_url": "/t/topic/1285/4",
            "text": "该问题已经解决，原因如下：\n1、BMC直连主板CPLD，因此不存在jtag switch切换的情况，主板SR中的FirmwareRoute需为0；\n2、BMC通过JTAG_0直连主板CPLD，因此主板sr中应该使用JTAG_0，而不是JtagOverLocalBus;\n总结：\n定位问题时，需先找硬件核对清楚BMC和主板之间是如何连接的，根据该结论去梳理拓扑是否有问题"
        },
        {
            "user_name": "discobot",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/1285/5",
            "text": "content: 你好！这个连接的信息可能对你解决本问题有所帮助，请参考，谢谢！\nlinks: https://discuss.openubmc.cn//t/topic/699/1"
        },
        {
            "user_name": "discobot",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/1285/6",
            "text": "content: 你好！这个连接的信息可能对你解决本问题有所帮助，请参考，谢谢！\nlinks: https://discuss.openubmc.cn//t/topic/699/1"
        }
    ]
}