{
    "topic_id": 1550,
    "question": "Atlas 300V pro NPU卡信息显示不全 - content: 【当前背景】\n代码版本：25.03\nMCU固件版本：24.5.9\n系统固件版本：7.5.0.5.220\n【问题描述】\n当前在openUBMC适配300V Pro的NPU卡，适配后显示的信息不全，没有显示内存容量和系统固件版本\n企业微信截图_175151451786981891×919 127 KB\n300V Pro CSR配置\n\"PCIeDevice_1\": {\n            \"Segment\": 1,\n            \"DeviceName\": \"PCIe Card $ (NPU)\",\n            \"DiagnosticFault\": 0,\n            \"PredictiveFault\": 0,\n            \"FunctionClass\": 9,\n            \"LinkSpeedReduced\": 0,\n            \"CorrectableError\": 0,\n            \"UncorrectableError\": 0,\n            \"FatalError\": 0,\n            \"Position\": \"\",\n            \"Container\": \"${Container}\",\n            \"GroupPosition\": \"PCIeDevice_${GroupPosition}\",\n            \"DeviceType\": 8,\n            \"PCIeDeviceType\": \"SingleFunction\",\n            \"SlotType\": \"FullLength\",\n            \"FunctionProtocol\": \"PCIe\",\n            \"FunctionType\": \"Physical\"\n        },\n        \"FruData_NPUCard\": {\n            \"FruId\": 1,\n            \"StorageType\": \"MCU\",\n            \"FruDev\": \"#/Chip_Dmini_Elabel\",\n            \"FruName\":\"<=/PCIeCard_1.Name\"\n        },\n        \"NPUCard_1\":{\n            \"Name\": \"<=/PCIeCard_1.Name\",\n            \"CardDescription\": \"<=/PCIeCard_1.Description\",\n            \"DeviceName\": \"<=/PCIeDevice_1.DeviceName\",\n            \"RefChip\":\"#/Chip_Dmini\",\n            \"RefEeprom\":\"#/Chip_Dmini_Elabel\",\n            \"RefFrudata\": \"#/FruData_NPUCard\",\n            \"Model\": \"Atlas_300I_Pro\",\n            \"SlotNumber\": \"${Slot}\",\n            \"PcbVersion\": \".A\",\n            \"BoardID\": 171,\n            \"FirmwareVersion\": \"N/A\",\n            \"CardPartNumber\": \"03028DFH\",\n            \"SerialNumber\":\"<=/FruData_NPUCard.BoardSerialNumber\"\n        },\n        \"Fru_NPUCard\": {\n            \"PcbVersion\": \".A\",\n            \"FruId\": 1,\n            \"PowerState\": 1,\n            \"FruName\": \"<=/PCIeCard_1.Name\",\n            \"Health\": 0,\n            \"EepStatus\": 1,\n            \"Type\": 8,\n            \"FruDataId\": \"#/FruData_NPUCard\"\n        },\n        \"PCIeCard_1\": {\n            \"DeviceName\": \"<=/PCIeDevice_1.DeviceName\",\n            \"SlotID\": \"<=/PCIeDevice_1.SlotID\",\n            \"NodeID\": \"<=/PCIeDevice_1.SlotID |> string.format('PCIeCard%s',$1)\",\n            \"Health\": \"<=/Component_PCIeCard.Health\",\n            \"Name\": \"#/NPUCard_1.BoardID |> expr( $1==182 ? 'Atlas 300V Video Analysis Card' : $1==175 ? 'Atlas 300V Pro Video Analysis Card' : 'Atlas 300I Pro Inference Card')\",\n            \"BoardName\": \"<=/FruData_NPUCard.BoardProductName;<=/FruData_NPUCard.BoardProductName |> string.cmp($1, '') |> expr($1 ? 'IT21PDDA' : $2)\",\n            \"Description\": \"#/PCIeCard_1.Name |> string.format('%s PCI-E 1*16x (HHHL)', $1)\",\n            \"FunctionClass\": 9,\n            \"VendorID\": 6629,\n            \"DeviceID\": 54528,\n            \"SubVendorID\": 512,\n            \"SubDeviceID\": 256,\n            \"Position\": \"<=/PCIeDevice_1.Position\",\n            \"LaneOwner\": \"<=/PCIeDevice_1.SocketID\",\n            \"FirmwareVersion\": \"#/NPUCard_1.FirmwareVersion\",\n            \"Manufacturer\": \"Huawei\",\n            \"PartNumber\": \"03028DFH\",\n            \"MaxFrameLen\": 64,\n            \"LinkSpeed\": \"N/A\",\n            \"LinkSpeedCapability\": \"N/A\",\n            \"PcbVersion\": \"#/NPUCard_1.PcbVersion\",\n            \"BoardID\": \"#/NPUCard_1.BoardID\",\n            \"DevBus\": \"<=/PCIeDevice_1.DevBus\",\n            \"DevDevice\": \"<=/PCIeDevice_1.DevDevice\",\n            \"SerialNumber\": \"<=/FruData_NPUCard.BoardSerialNumber\",\n            \"DevFunction\": \"<=/PCIeDevice_1.DevFunction\"\n        },\n\n在ibmc v2版本上进行交叉验证发现这些信息可以正常显示\n4bdc7181-c366-46ae-9d80-304bbc3e88311872×954 50.1 KB\n使用300I Duo的卡适配openUBMC后，系统版本和内存容量可以正常显示\n企业微信截图_175099676667511920×945 42.7 KB\n300I Duo CSR配置文件\n\"PCIeDevice_1\": {\n            \"Segment\": 1,\n            \"DeviceName\": \"PCIe Card $ (Atlas 300I Duo)\",\n            \"DiagnosticFault\": 0,\n            \"PredictiveFault\": 0,\n            \"FunctionClass\": 9,\n            \"LinkSpeedReduced\": 0,\n            \"CorrectableError\": 0,\n            \"UncorrectableError\": 0,\n            \"FatalError\": 0,\n            \"Position\": \"\",\n            \"Container\": \"${Container}\",\n            \"GroupPosition\": \"PCIeDevice_${GroupPosition}\",\n            \"DeviceType\": 8,\n            \"PCIeDeviceType\": \"SingleFunction\",\n            \"SlotType\": \"FullLength\",\n            \"FunctionProtocol\": \"PCIe\",\n            \"FunctionType\": \"Physical\"\n        },\n        \"FruData_NPUCard\": {\n            \"FruId\": 1,\n            \"StorageType\": \"MCU\",\n            \"FruDev\": \"#/Chip_Dmini_Elabel\"\n        },\n        \"Fru_NPUCard\": {\n            \"PcbVersion\": \".A\",\n            \"FruId\": 1,\n            \"PowerState\": 1,\n            \"FruName\": \"Atlas 300I Duo\",\n            \"Health\": 0,\n            \"EepStatus\": 1,\n            \"Type\": 8,\n            \"FruDataId\": \"#/FruData_NPUCard\"\n        },\n        \"NPUCard_1\":{\n            \"Name\": \"Atlas 300I Duo Inference Card\",\n            \"CardDescription\": \"Atlas 300I Duo Inference Card PCI-E 1*16x(FHFL)\",\n            \"DeviceName\": \"<=/PCIeDevice_1.DeviceName\",\n            \"RefChip\":\"#/Chip_Dmini\",\n            \"RefEeprom\":\"#/Chip_Dmini_Elabel\",\n            \"RefFrudata\": \"#/FruData_NPUCard\",\n            \"Model\": \"Atlas_300I_Duo\",\n            \"SlotNumber\": \"${Slot}\",\n            \"PcbVersion\": \".A\",\n            \"BoardID\": 177,\n            \"FirmwareVersion\": \"N/A\",\n            \"CardPartNumber\": \"03029WRV\",\n            \"SerialNumber\":\"<=/FruData_NPUCard.BoardSerialNumber\"\n        },\n        \"PCIeCard_1\": {\n            \"DeviceName\": \"<=/PCIeDevice_1.DeviceName\",\n            \"SlotID\": \"<=/PCIeDevice_1.SlotID\",\n            \"NodeID\": \"<=/PCIeDevice_1.SlotID |> string.format('PCIeCard%s',$1)\",\n            \"Health\": \"<=/Component_PCIeCard.Health\",\n            \"Name\": \"Atlas 300I Duo\",\n            \"BoardName\": \"<=/FruData_NPUCard.BoardProductName;<=/FruData_NPUCard.BoardProductName |> string.cmp($1, '') |> expr($1 ? 'IT21PD2E' : $2)\",\n            \"Description\": \"Atlas 300I Duo Inference Card PCI-E 1*16x(FHFL)\",\n            \"FunctionClass\": 9,\n            \"VendorID\": 6629,\n            \"DeviceID\": 54528,\n            \"SubVendorID\": 512,\n            \"SubDeviceID\": 272,\n            \"Position\": \"<=/PCIeDevice_1.Position\",\n            \"LaneOwner\": \"<=/PCIeDevice_1.SocketID\",\n            \"FirmwareVersion\": \"#/NPUCard_1.FirmwareVersion\",\n            \"Manufacturer\": \"Huawei\",\n            \"PartNumber\": \"03029WRV\",\n            \"MaxFrameLen\": 32,\n            \"LinkSpeed\": \"N/A\",\n            \"LinkSpeedCapability\": \"N/A\",\n            \"PcbVersion\": \"#/NPUCard_1.PcbVersion\",\n            \"BoardID\": \"#/NPUCard_1.BoardID\",\n            \"DevBus\": \"<=/PCIeDevice_1.DevBus\",\n            \"DevDevice\": \"<=/PCIeDevice_1.DevDevice\",\n            \"SerialNumber\": \"\",\n            \"DevFunction\": \"<=/PCIeDevice_1.DevFunction\"\n        },\n\n【疑问点】\n使用类似的CSR配置文件对两张NPU卡进行适配，为什么300I DUO的卡可以正常显示信息，300V Pro却不能显示系统固件版本和内存容量，300V Pro的卡是否支持显示这两条信息\nlinks: https://discuss.openubmc.cn/uploads/default/original/2X/2/2109715c01ffca08f3c9d10e6bf67626dd66533f.png, https://discuss.openubmc.cn/uploads/default/original/2X/e/e800ab922409301c915be3d2b6f0b34c6c112618.png, https://discuss.openubmc.cn/uploads/default/original/2X/1/15fc3136f4ecbc57cc048e987595966bcbe48339.png",
    "topic_user_name": "百信-张滨",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "长江-涂华能",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1550/2",
            "text": "我认为可先查看下OS下的300V Pro驱动和固件是否安装并配套"
        }
    ]
}