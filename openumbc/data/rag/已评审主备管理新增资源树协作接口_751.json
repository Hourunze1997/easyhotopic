{
    "topic_id": 751,
    "question": "【已评审】主备管理新增资源树协作接口 - content: 关联Issuse\n支持BMC设备升主能力\n评审背景\n需求\n\n新增主备管理功能，需要提供资源协作接口用于查询/倒换主备状态\n\n差距\n当前未实现主备管理功能，无资源协作接口承载相关功能\n评审点\n评审点一\npath /bmc/kepler/Managers/:ManagerId/LocalActiveStandbyMgmt\ninterfacebmc.kepler.Managers.ActiveStandbyMgmt\n背景说明\n增加本板对象，主要用于写寄存器以及查询本板的主备状态等\n\n名称\n数据类型\n读写权限\n持久化\n信号\n说明\n\nSlotId\ny\nro\n否\n否\n槽位IdCSR配置\n\nPresence\ny\nro\n否\n否\n在位状态(0:不在位 1:在位)CSR配置\n\nActiveStandbyStatus\ny\nrw\n否\n否\n软件主备状态(0:主 1:备)由组件更新\n\n私有属性\n\n属性名称\n类型\n读写权限\n持久化\n信号\n说明\n\nHwActiveStandbyStatus\ny\nrw\n否\n否\n硬件主备状态(0:主 1:备)CSR配置\n\nStandbyToActiveAccessor\ny\nrw\n否\n否\n升主寄存器CSR配置\n\nActiveToStandbyAccessor\ny\nrw\n否\n否\n降备寄存器CSR配置\n\nStandbyToActiveWriteProtect\ny\nrw\n否\n否\n升主写保护寄存器CSR配置\n\nActiveToStandbyWriteProtect\ny\nrw\n否\n否\n降备写保护寄存器CSR配置\n\n方法\n\n切换主备状态\n获取主备状态\n\n方法名\nSwitchAsStatus\nGetAsStatus\n\n请求签名\ns\n-\n\n请求说明\nRequestCause:请求原因\n-\n\n响应签名\nss\ny\n\n响应说明\nReturnCode:返回码 ReturnMsg:返回信息\nStatus：主备状态\n\n评审点二\npath /bmc/kepler/Managers/:ManagerId/RemoteActiveStandbyMgmt/:Id\ninterfacebmc.kepler.Managers.RemoteActiveStandbyMgmt\n背景说明\n增加对板对象，提供对板状态信息查询\n\n属性名称\n类型\n读写权限\n持久化\n信号\n说明\n\nActiveStandbyStatus\ny\nrw\n否\n否\n主备状态(0:主 1:备)由组件进行更新\n\nSlotId\ny\nro\n否\n否\n槽位IdCSR配置\n\nPresence\ny\nro\n否\n否\n在位状态(0:不在位 1:在位)CSR配置\n\nCommunicationIP\ns\nro\n否\n否\n通信IpCSR配置\n\nCommunicationPort\nq\nro\n否\n否\n通信端口CSR配置\n\nCommunicationStatus\ny\nro\n否\n否\n通信状态(0:异常 1:正常)CSR配置\n\n方法\n\n切换主备状态\n获取主备状态\n查询健康状态\n\n方法名\nSwitchAsStatus\nGetAsStatus\nGetHealthStatus\n\n请求签名\ns\n-\n-\n\n请求说明\nRequestCause:请求原因\n-\n-\n\n响应签名\nss\ny\ny\n\n响应说明\nReturnCode:返回码 ReturnMsg:返回信息\nStatus：主备状态\nStatus:健康状态\n\n评审点三\n私有对象  SwitchOverRules(主备切换条件)\n背景说明\n指可以通过模型进行配置的切换条件，针对的是对于产品来说静态的可以直接在模型中配置的数据或者是动态的但是可以通过其他资源协作接口等方式配置出来的条件\n\n属性名称\n类型\n读写权限\n持久化\n信号\n说明\n\nSwitchType\ny\nro\n否\n否\n条件类型(0: 允许切换条件 1:禁止切换条件)CSR配置\n\nThreshold\ny\nro\n否\n否\n主备切换条件的门限值CSR配置\n\nReading\ny\nro\n否\n否\n主备切换条件的输入值CSR配置\n\nOperator\ny\nro\n否\n否\n主备切换条件的运算符 1：大于2：大于等于3：小于4：小于等于5：等于6：不等于CSR配置\n\nDirection\ny\nro\n否\n否\n主备切换的方向(0:无操作 1:降备 2:升主)CSR配置\n\nDescription\ns\nro\n否\n否\n主备切换条件匹配之后的描述值CSR配置\n\n评审点四\n私有对象\n对象名ActiveStandbyHeartBeat(备选HealthMaintenance)\n背景说明\n通过一直写心跳寄存器来告知硬件需要参与主备的状态冲裁，检测周期等需要支持配置\npath/bmc/kepler/Managers/:ManagerId/LocalActive\ninterfacebmc.kepler.Manager.LocalActive\n\n属性名称\n类型\n读写权限\n持久化\n信号\n说明\n\nHeartbeatStatus\ny\nro\n否\n是\nBMC的主备心跳状态(0：丢失 1：正常)由组件进行更新\n\n私有属性\n\n属性名称\n类型\n读写权限\n持久化\n信号\n说明\n\nHeartbeatInterval\nq\nro\n否\n否\n主备心跳检测周期（毫秒）CSR配置\n\nHeartbeatAccessor\ny\nrw\n否\n否\n硬件主备心跳的AccessorCSR配置\n\nHeartbeatThreshold\nq\nro\n否\n否\n主备心跳的预警门限（毫秒）CSR配置\n\n评审结论\n不通过，当前方案不明确，需要进行方案评审之后再行进行接口评审\nlinks: https://gitcode.com/openUBMC/active_standby_mgmt/issues/1",
    "topic_user_name": "sunpeijun",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "pengqiang",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/751/2",
            "text": "content: 资源协作接口不要横表，不然有些内容展示不全，展示采用纵表的方式\n主备切换允许接口和禁止接口完全一致，是否可以归一\n当前评审内容较多，各个评审点汇聚一下，准备好每个评审点的背景\n@spjisgood_2lbdb  请关注上述问题\nlinks: /u/spjisgood_2lbdb"
        },
        {
            "user_name": "pengqiang",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/751/3",
            "text": "每个接口的属性要明确详细的功能以及使用说明，包括但不限于：\nHeartbeatAccessor 等硬件信号接口，要明确是CSR配置，是否可以读写还是只读\nHeartbeatStatus 等软件状态接口，是组件直接软件更新还是需要硬件获取"
        },
        {
            "user_name": "pengqiang",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/751/4",
            "text": ""
        }
    ]
}