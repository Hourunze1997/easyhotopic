{
    "topic_id": 1476,
    "question": "【已评审】snmp、cli接口查询、设置syslog日志类型为all的含义评审 - content: ISSUE链接\n背景\n历史版本中，snmp接口查询syslog日志类型，由于只有操作日志、安全日志和事件日志三种类型且使能都默认打开，因此snmp接口查询默认结果为all。\n在后续版本中syslog新增了入侵检测日志类型（默认关闭）。如果用户从旧版本升级到新版本，并且没设置syslog日志类型的场景下，在新版本中snmp接口查询默认结果从all变为了OperationLogs,SecurityLogs,EventLogs，用户侧的预期结果发生了变化（用户预期会返回all）。\ncli接口存在类似问题，设置接口可以通过设置all打开所有日志类型使能，在老版本中，all代表开启操作日志、安全日志和事件日志使能，在新版本中all代表开启操作日志、安全日志、事件日志和入侵检测日志使能。\n决策点\n一、snmp接口查询、设置syslog日志类型为all的处理策略评审\nsnmp接口名：/snmp/1.3.6.1.4.1.{{SnmpOemIdentifier}}.34.50/syslogInfoDescriptionTable/Readwrite\n属性名：syslogSendLogType\n方案1： 无论查询还是设置，all仅代表操作日志、安全日志和事件日志这三种日志使能；\n如果要打开操作日志、安全日志、事件日志和入侵检测日志四个日志的使能，只能用\"OperationLogs,SecurityLogs,EventLogs,IntrusionDetectionLogs\"的格式进行设置。\n如果四种日志类型使能都打开，查询结果也是\"OperationLogs,SecurityLogs,EventLogs,IntrusionDetectionLogs\"的格式\n1）设置场景请求示例\n\nsnmp设置场景请求值\n日志类型说明\n\nnone\n空\n\nOperationLogs\n操作日志\n\nSecurityLogs\n安全日志\n\nEventLogs\n事件日志\n\nIntrusionDetectionLogs\n入侵检测日志\n\nOperationLogs,EventLogs\n操作日志，事件日志\n\nOperationLogs,EventLogs,IntrusionDetectionLogs\n操作日志，事件日志，入侵检测日志\n\nall 或 OperationLogs,SecurityLogs,EventLogs\n操作日志，安全日志，事件日志\n\nOperationLogs,SecurityLogs,EventLogs,IntrusionDetectionLogs\n操作日志，安全日志，事件日志，入侵检测日志\n\n2）查询场景响应示例\n\nsnmp查询场景响应\n日志类型说明\n\nnone\n空\n\nOperationLogs\n操作日志\n\nSecurityLogs\n安全日志\n\nEventLogs\n事件日志\n\nIntrusionDetectionLogs\n入侵检测日志\n\nOperationLogs,EventLogs\n操作日志，事件日志\n\nOperationLogs,EventLogs,IntrusionDetectionLogs\n操作日志，事件日志，入侵检测日志\n\nall\n操作日志，安全日志，事件日志\n\nOperationLogs,SecurityLogs,EventLogs,IntrusionDetectionLogs\n操作日志，安全日志，事件日志，入侵检测日志\n\n方案2： syslogSendLogType节点中all只表示操作日志、安全日志和事件日志使能，新增oid节点用于入侵检测日志使能显示\nsnmp接口名：/snmp/1.3.6.1.4.1.{{SnmpOemIdentifier}}.34.50/syslogInfoDescriptionTable/Readwrite\n新增节点名称：syslogIntrusionDetectionLogEnabled\n类型：integer\n权限：Readwrite\n\n使能状态\n取值类型\n\n关闭\n1\n\n打开\n2\n\n二、cli接口设置syslog日志类型值为all的处理策略评审\n方案1： 无论查询还是设置，all仅代表操作日志、安全日志和事件日志这三种日志使能；\ncli命令名 ：ipmcset -t syslog -d logtype -v  \n设置all为开启操作日志、安全日志和事件日志使能，\n设置operationlogs,securitylogs,eventlogs,intrusion_detectionlogs才是开启操作日志、安全日志、事件日志和入侵检测日志使能\ncli命令ipmcget -t syslog -d iteminfo查询syslog日志类型不会显示为all，操作日志、安全日志和事件日志使能回显为operationlogs securitylogs eventlogs；\n操作日志、安全日志、事件日志和入侵检测日志使能回显为operationlogs securitylogs eventlogs intrusion_detectionlogs\n\ncli设置取值\n日志类型说明\n\nnone\n空\n\noperationlogs\n操作日志\n\nsecuritylogs\n安全日志\n\neventlogs\n事件日志\n\nintrusion_detectionlogs\n入侵检测日志\n\noperationlogs,eventlogs\n操作日志，事件日志\n\noperationlogs,eventlogs,intrusion_detectionlogs\n操作日志，事件日志，入侵检测日志\n\nall 或者 operationlogs,securitylogs,eventlogs\n操作日志，安全日志，事件日志\n\noperationlogs,securitylogs,eventlogs,intrusion_detectionlogs\n操作日志，安全日志，事件日志，入侵检测日志\n\n方案2：增加参数，单独表示入侵检测日志\nipmcset -t syslog -d intrusiondetectionlogs -v 1 disabled/enabled\n评审结论：\n1、snmp 接口评审结论 ：\na）文档中说明设置logtype属性时，all参数不再推荐使用（会逐步废弃），建议用户填写具体的日志类型；如果下发all参数，则表示开启当前版本snmp接口支持的所有日志类型；\nb）查询logtype属性时，如果显示all，则表示当前版本snmp接口支持开启的所有日志类型。\nc）如果旧版本设置为all，升级到新版本将按照实际开启的日志类型进行返回（例如返回“OperationLogs,SecurityLogs,EventLogs”）。\n2、cli 接口评审结论 ：\n设置接口all参数保持不变，但是需要在cli接口设置all参数成功时，在接口回显中提示用户当前生效的日志类型有哪些。\n经确认，上述处理策略不影响社区用户相关接口使用。\nlinks: #p-3543-issue-1, #p-3543-h-2, #p-3543-h-3, #p-3543-snmpsyslogall-4, #p-3543-clisyslogall-5, #p-3543-h-6",
    "topic_user_name": "HuoJianCong",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "huanghan",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1476/2",
            "text": ""
        }
    ]
}