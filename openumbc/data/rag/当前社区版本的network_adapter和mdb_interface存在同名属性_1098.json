{
    "topic_id": 1098,
    "question": "当前社区版本的network_adapter和mdb_interface存在同名属性; - content: [问题描述]\n使用bingo gen对netword_adapter进行代码生成. 提示RuntimeError: 在model.json文件NetworkAdapter类的bmc.kepler.Inventory.Hardware接口中发现重名资源树属性Model.\n通过更新network_adapter和mdb_interface代码, 编译mdb_interface代码, 编译network_adapter, 发现问题依旧.\n[定位]\n代码结点:\nnetwork_adapter\ncommit 622ca21d62940e6a1afc95ef65f2876ecfabf94f (HEAD -> main)\nMerge: f7f07f2 fcbc214\nAuthor: openUBMC-robot <chaotomzhu@gmail.com>\nDate:   Tue May 20 21:49:26 2025 +0800\n\n    merge main into main\n    \n    NCSI边带管理能力新增aen, mac相关功能\n\n通过\npython -m pdb /home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py -i /home/workspace/network_adapter/mds/model.json -o /home/workspace/network_adapter/temp/lua_codegen/temp/network_adapter/_model.json -d /home/workspace/network_adapter/temp/lua_codegen/../../temp/opt/bmc/apps/mdb_interface/ -c /home/workspace/network_adapter/temp/lua_codegen/script/../temp/check_cmd.json\n\n调试, 打印class_data数据\nprint_class_data.json.txt (25.0 KB)\n可知, 当前报错点在于\nclass_name 为NetworkAdapter的类存在2个interface,\n\"bmc.kepler.Inventory.Hardware\"下的属性Model, 和 \"bmc.kepler.Systems.NetworkAdapter\"下的属性Model, 被认为是同名属性.\n然而实际上这是2个interface. 但是bmc旧版本的sr配置, interface下的属性和类的私有属性是同级的, 故而, merge_model.py要求其不能同名的逻辑是正确的.\n因此, 是interface的随意添加导致的冲突.\n查看代码,\n发现 \"bmc.kepler.Inventory.Hardware\"下的属性Model,是5-15上库的代码导致的\nimage1411×494 59.6 KB\n然而, 逻辑上,  \"bmc.kepler.Inventory.Hardware\"和\"bmc.kepler.Systems.NetworkAdapter\"是2个接口, mdb_interface是没法识别他们被一个类NetworkAdapter引用, 导致冲突的.\n因此, 似乎上面\"要求其不能同名的逻辑\", 在设计上或者代码审核上似乎没有考虑好,class引用了不同的interface的情况\n[日志]:\n执行日志如下\nrun.log.txt (18.9 KB)\n......\n......\npython3 /home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py -i /home/workspace/network_adapter/mds/model.json -o /home/workspace/network_adapter/temp/lua_codegen/temp/network_adapter/_model.json -d /home/workspace/network_adapter/temp/lua_codegen/../../temp/opt/bmc/apps/mdb_interface/ -c /home/workspace/network_adapter/temp/lua_codegen/script/../temp/check_cmd.json\nTraceback (most recent call last):\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 293, in <module>\n    main(sys.argv[1:])\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 289, in main\n    generate(m_input, output, mdb_path, cmd_file)\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 253, in generate\n    merge_model(load_dict, mdb_path)\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 205, in merge_model\n    check_property_name_conflict(origin_model)\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 195, in check_property_name_conflict\n    check_class_property_name_conflict(class_name, class_data)\n  File \"/home/workspace/network_adapter/temp/lua_codegen/script/merge_model.py\", line 188, in check_class_property_name_conflict\n    raise RuntimeError(f\"在model.json文件{class_name}类的{interface}接口中发现重名资源树属性{prop_name}\")\nRuntimeError: 在model.json文件NetworkAdapter类的bmc.kepler.Inventory.Hardware接口中发现重名资源树属性Model\nmake[3]: *** [Makefile:131: /home/workspace/network_adapter/temp/lua_codegen/temp/network_adapter/_model.json] Error 1\nmake[3]: Leaving directory '/home/workspace/network_adapter/temp/lua_codegen/templates/apps'\nmake[2]: *** [Makefile:12: apps] Error 2\nmake[2]: Leaving directory '/home/workspace/network_adapter/temp/lua_codegen/templates'\nmake[1]: *** [Makefile:68: gen] Error 2\nmake[1]: Leaving directory '/home/workspace/network_adapter/temp/lua_codegen'\nmake: *** [Makefile:25: gen] Error 2\nERROR: Traceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/cli/cli.py\", line 355, in run\n    return method(command_args)\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/cli/cli.py\", line 159, in gen\n    gen.run()\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/component/gen.py\", line 110, in run\n    self.generate_lua_run(parser, base_version)\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/component/gen.py\", line 122, in generate_lua_run\n    codegen.gen(args)\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/codegen/lua/codegen.py\", line 164, in gen\n    self.generate_code_run(args)\n  File \"/usr/local/lib/python3.12/dist-packages/bmcgo/codegen/lua/codegen.py\", line 145, in generate_code_run\n    subprocess.run(cmd, env=dict(os.environ, LUA_FORMAT=lua_format, LUA_CODEGEN_VERSION=str(self.version),\n  File \"/usr/lib/python3.12/subprocess.py\", line 571, in run\n    raise CalledProcessError(retcode, process.args,\nsubprocess.CalledProcessError: Command '['/usr/bin/make', '-j12', 'PROJECT_NAME=network_adapter', 'TPL_DIR=/home/workspace/network_adapter/temp/lua_codegen', 'VERSION=8', 'gen']' returned non-zero exit status 2.\n\nERROR: Command '['/usr/bin/make', '-j12', 'PROJECT_NAME=network_adapter', 'TPL_DIR=/home/workspace/network_adapter/temp/lua_codegen', 'VERSION=8', 'gen']' returned non-zero exit status 2.\nERROR: 请查看日志信息\nlinks: /uploads/short-url/vLCbAhshVeEa6oGU017aCyQa868.txt, https://discuss.openubmc.cn/uploads/default/original/1X/c4371860044d98377f077f139d5c1e30e915da88.png, /uploads/short-url/e0BxrBRJx7yeSQLQCM0UdMkoOjU.txt",
    "topic_user_name": "河南昆仑-郑豪伟",
    "best_answer_url": "/t/topic/1098/3",
    "reply_posts": [
        {
            "user_name": "maoyuhao",
            "topic_closed": true,
            "is_solution": false,
            "post_url": "/t/topic/1098/2",
            "text": "回复已收到问题，正在确定原因。"
        },
        {
            "user_name": "maoyuhao",
            "topic_closed": true,
            "is_solution": true,
            "post_url": "/t/topic/1098/3",
            "text": "最新代码已解决"
        }
    ]
}