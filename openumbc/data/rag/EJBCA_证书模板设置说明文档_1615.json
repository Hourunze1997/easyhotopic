{
    "topic_id": 1615,
    "question": "📘 EJBCA 证书模板设置说明文档. - content: EJBCA 终端证书模板设置说明文档\n本指南用于解释 EJBCA 中终端证书模板（Certificate Profile）设置项的具体含义及推荐用途，适用于 HTTPS/Web/设备/客户端等常见终端证书签发需求。\n\n 基本信息\n\n配置项\n描述\n\nCertificate Profile ID\n模板在数据库中的唯一标识，仅供系统内部识别\n\n类型\n可用终端实体，子CA，根CA\n\nAvailable Key Algorithms\n可用密钥算法，如 RSA、ECDSA、Ed25519、国密算法（如 DILITHIUM）等\n\nAvailable ECDSA curves\nECDSA 可选曲线，当前未启用任何曲线\n\n可用位长度\n支持的密钥位数（针对 RSA），如 2048、4096 等\n\n签名算法\n用于签发证书时的签名哈希算法，如 SHA3-256withRSA\n\nAlternative Signature\n是否启用替代签名算法，如 ECDSA, EdDSA 等\n\n有效期 or end date of the certificate\n默认有效期，如 “2y” 表示 2 年\n\nValidity Offset\n签发日期的偏移量，允许向前或向后设定起始时间\n\nExpiration Restrictions\n限制最大到期时间，用于合规控制\n\nProfile Description\n证书模板说明，用于备注用途（如“终端设备证书”）\n\n 权限控制（Permissions）\n\n配置项\n描述\n推荐设置\n\nAllow Validity Override\n允许在签发证书时覆盖默认有效期\n，如需手动调整有效期时使用\n\nAllow Expired Validity End Date\n允许设置一个已过期的结束时间（用于测试或审计）\n（调试用）\n\nAllow Extension Override\n允许 CSR 中的扩展字段覆盖模板中预定义的扩展\n，若开启会破坏模板统一性，可能引入风险\n\nAllow certificate serial number override\n允许在签发时自定义证书序列号\n，仅特定需求下开启（如证书克隆、替换）\n\nAllow Subject DN Override by CSR\n允许 CSR 中的主题信息（如 CN/O）覆盖模板配置\n，适用于自动化签发流程\n\nAllow Subject DN Override by End Entity Information\n允许通过终端实体信息（用户输入）指定 Subject 字段\n，灵活性高，推荐开启\n\nAllow Key Usage Override\n允许 CSR 中设置 keyUsage 字段覆盖模板配置\n，开启会造成用途不一致，影响安全性\n\nAllow Backdated Revocation\n允许将吊销时间设置为历史时间，用于追溯性撤销\n，部分审计/合规场景下需要\n\nUse Certificate Storage\n启用证书在数据库中存储（必须开启，除非特殊离线用途）\n\nStore Certificate Data\n存储证书完整原文数据（配合 OCSP/CRL 使用）\n，建议与存储功能一同开启\n\n 建议：在生产环境中保持模板统一性，除非明确需要，否则尽量关闭 Override 类权限项，避免 CSR/End Entity 越权操作。\n\n X.509v3 扩展 - 基础信息\n\n扩展项\n描述\n推荐设置\n\n基本约束（Basic Constraints）\n限制是否为 CA 证书（终端证书应设为 FALSE）\n 使用，关键\n\nCA密钥标识符\n标识签发 CA 的信息\n 使用\n\n主题密钥标识符\n生成此证书的唯一标识\n 使用\n\n X.509v3 扩展 - 密钥用途（Key Usage）\n\n项目\n描述\n\n数字签名 (digitalSignature)\n用于验证签名，如身份认证、代码签名\n\n不可抵赖 (nonRepudiation)\n表明签名不可否认（法律场景）\n\n数据加密 (dataEncipherment)\n用于加密非密钥数据\n\n密钥加密 (keyEncipherment)\n用于加密密钥材料，如对称密钥\n\n密钥协议 (keyAgreement)\n支持密钥协商协议（如 DH）\n\nCRL签名 (cRLSign)\n用于签署吊销列表（CA 用）\n\n密钥证书签名 (keyCertSign)\n用于签署证书（CA 用）\n\n只用于加密 (encipherOnly)\n与密钥协议联合使用（仅加密）\n\n只用于解密 (decipherOnly)\n与密钥协议联合使用（仅解密）\n\nForbid encryption usage for ECC keys\n禁止 ECC 密钥用于加密\n\n X.509v3 扩展 - 扩展密钥用途（Extended Key Usage）\n\n扩展用途\n描述\n\nTLS client\n用于客户端 TLS 认证\n\nTLS server\n用于服务器 TLS 认证\n\nEAP over LAN (EAPOL)\n企业网身份认证\n\nEAP over PPP\n点对点协议身份认证\n\nETSI TSL Signing\n用于 ETSI TSL 签名场景\n\nICAO Deviation List Signing\nICAO 签名用途之一\n\nICAO Master List Signing\nICAO 主列表签名\n\nIntel AMT management\nIntel 管理认证专用\n\nInternet Key Exchange for IPsec\nIPsec 密钥交换\n\nKerberos Client Authentication\nKerberos 客户端认证\n\nKerberos KDC\nKerberos 密钥中心\n\nMS CA Key Exchange\nMicrosoft CA 密钥交换用途\n\nMS Commercial Code Signing\nMicrosoft 商业代码签名\n\nMS Document Signing\nMicrosoft 文档签名\n\nMS EFS Recovery\nMicrosoft EFS 恢复用途\n\nMS Encrypted File System\nMicrosoft 加密文件系统用途\n\nMS Individual Code Signing\nMicrosoft 个人代码签名\n\nMS 智能卡登录\nMicrosoft 智能卡登录验证\n\nOCSP 签发者\n在线证书状态协议（OCSP）签名证书用途\n\nPDF Signing\n用于 PDF 文件签名\n\nPIV Card Authentication\nPIV 卡身份认证\n\nRFC9336 Document Signing\n符合 RFC9336 的文档签名用途\n\nSCVP Client\n简化证书验证协议客户端\n\nSCVP Server\n简化证书验证协议服务端\n\nSIP Domain\n用于 VoIP/SIP 域名认证用途\n\nSSH Client\n用于 SSH 客户端认证\n\nSSH Server\n用于 SSH 服务器认证\n\n代码签名 (codeSigning)\n用于软件/驱动程序签名\n\n任意扩展的密钥用途\n任意通用用途扩展支持\n\n安全 Email (emailProtection)\nS/MIME 邮件签名/加密用途\n\n客户身份验证 (clientAuth)\n用于 TLS 客户端身份认证\n\n时间戳 (timeStamping)\n时间戳服务签名用途\n\n服务器验证 (serverAuth)\n用于服务器身份验证（HTTPS 等）\n\n 名称扩展\n\n项目\n描述\n建议\n\n主题别名（Subject Alt Name）\n支持 IP/DNS/UEmail 作为证书标识\n 使用\n\nIssuer Alternative Name\n可添加额外的 CA 名称信息\n可选\n\nName Constraints\n限定主题中可用的命名空间\n可选（高安全场景使用）\n\n 验证扩展（Validation Data）\n\n项目\n描述\n推荐\n\nCRL 发布点\n证书吊销列表地址\n 使用，关键\n\nDelta CRL（Freshest CRL）\n增量吊销列表\n按需开启\n\nAuthority Information Access (AIA)\n提供 OCSP/CA 信息\n\n 私钥使用期限制\n\n项目\n描述\n\nStart Offset\n私钥可用的起始偏移时间\n\nPeriod Length\n私钥的可使用周期（独立于证书有效期）\n\n ETSI 合规扩展（一般用于合规性要求高的 PKI 环境）\n\n项目\n描述\n\n资质证书声明\n用于标识法律或合规用途证书\n\nAssured validity\n确保短期证书的有效性\n\n 其他扩展（Other Extensions）\n\n扩展\n用途\n\nOCSP No Check\n禁用 OCSP 检查（通常仅对 OCSP responder 有用）\n\nMicrosoft 模板值\n用于 Windows AD 集成的特殊扩展\n\nCA/B Forum OID\n用于 CA/B 合规的组织标识扩展\n\n 审批设置 & 附加字段\n\n配置项\n说明\n\n添加/编辑终端实体\n绑定的审批流程（如 sub CA）\n\n密钥恢复\n是否支持密钥找回（如用于备份恢复）\n\n撤销审批\n吊销时是否需审批\n\nCN 后缀\n在 Subject CN 后自动添加字符串\n\n主题字段子集限制\n限制允许使用的 Subject 字段\n\n CA & 发布设置\n\n项目\n说明\n\n可用的 CA\n允许哪些 CA 使用此证书模板\n\n发布器（Publisher）\n可配置发布至 LDAP、数据库或外部服务\n\n单证书限制\n是否启用一个 End Entity 只能有一张有效证书\n\nAccount Binding Namespace\n用于设备账户绑定场景（如 IoT）\n\n如需继续配置 “代码签名证书” 模板，请在此基础上调整 keyUsage 与 extendedKeyUsage 字段即可。\n\n 建议对不同应用（如：VPN、HTTPS、代码签名、客户端认证）创建不同模板，便于管理和合规控制。\n\n 代码签名证书模板设置指南（EJBCA）\n本章节用于配置适用于软件、固件、驱动签名的 代码签名证书（Code Signing Certificate）模板。该模板推荐在 EJBCA 中单独创建，以确保签发出的证书用途清晰、用途受限、兼容常见签名工具（如 Microsoft signtool、GPG、jarsigner 等）。\n\n 基础配置建议\n\n配置项\n推荐值\n说明\n\n类型\n终端证书\n终端证书\n\n可用密钥算法\nRSA（2048 或 4096）/ Ed25519\n主流签名工具对 RSA 支持最好；部分支持 EdDSA\n\n签名算法\nSHA256withRSA / SHA3-256withRSA\n建议使用 SHA256 或以上哈希算法\n\n有效期\n1y 或 2y\n代码签名证书有效期建议不超过 3 年\n\n 权限控制推荐（Permissions）\n\n项目\n建议\n说明\n\nAllow Validity Override\n 禁止\n防止用户更改有效期\n\nAllow Extension Override\n 禁止\n保证模板一致性\n\nAllow Subject DN Override by CSR\n 允许\n支持自动化请求中的 DN 设定\n\nAllow Key Usage Override\n 禁止\n限定用途为签名，不可更改\n\nUse Certificate Storage / Store Certificate Data\n 开启\n保证支持 CRL/OCSP 查询和日志审计\n\n Key Usage 设置（密钥用途）\n启用以下选项并设置为“关键”：\n\n digitalSignature\n nonRepudiation\n\n禁用其他所有选项。\n nonRepudiation 用于法律上增强签名不可否认性。\n\n Extended Key Usage（扩展密钥用途）\n仅启用以下项并标记为关键：\n\n codeSigning\n\n禁用其他项（如 serverAuth、clientAuth、emailProtection 等）以限制用途。\n\n Subject DN 建议字段\n\n字段\n示例值\n说明\n\nCN\nHuawei Software Signer 01\n通常用于标识签名主体\n\nO\nHuawei Technologies\n公司名\n\nC\nCN\n国家码\n\n 安全建议\n\n该模板不应被 CA 或管理员直接使用，应通过审批流程控制发放\n建议将此模板绑定至 代码签名使用者角色，并使用 RA 审批或管理员审批方式颁发\n对签发出的证书可启用 CRL 发布、AIA 访问、吊销审批等审计机制\n\n 配置完成后，即可用于：\n\nWindows .exe/.dll/.msi 等签名\nJava .jar/.apk 签名\nLinux 内核模块签名\nGit 代码提交签名（搭配 GPG 证书）\n\n如需进一步扩展用途（如时间戳服务器、PDF 签名），建议创建专门模板以分离风险。\nlinks: #p-3922-ejbca-1, #p-3922-h-2, #p-3922-permissions-3, #p-3922-x509v3-4, #p-3922-x509v3-key-usage-5, #p-3922-x509v3-extended-key-usage-6, #p-3922-h-7, #p-3922-validation-data-8, #p-3922-h-9, #p-3922-etsi-pki-10, #p-3922-other-extensions-11, #p-3922-h-12, #p-3922-ca-13, #p-3922-ejbca-14, #p-3922-h-15, #p-3922-permissions-16, #p-3922-key-usage-17, #p-3922-extended-key-usage-18, #p-3922-subject-dn-19, #p-3922-h-20",
    "topic_user_name": "shenwei 百信信息技术",
    "best_answer_url": "",
    "reply_posts": []
}