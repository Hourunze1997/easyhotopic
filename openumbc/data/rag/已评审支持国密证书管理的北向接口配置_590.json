{
    "topic_id": 590,
    "question": "【已评审】支持国密证书管理的北向接口配置 - content: ISSUE链接\n【需求】支持国密证书管理的北向接口配置-rackmount-GitCode\n背景\n支持国密HTTPS证书的北向接口\n决策点\n1、新增redfish/rest中GenerateCSR接口的可选参数KeyPairAlgorithm\n2、新增rest接口：/UI/Rest/AccessMgnt/CertMgnt/CertsInformation/GmCerts\n3、新增资源协作接口GenerateCSR\n4、新增ipmi文件操作类型：国密SSL/CSR文件\n详细描述\n一、redfish新增可选参数KeyPairAlgorithm\nuri：/redfish/v1/CertificateService/Actions/CertificateService.GenerateCSR\n变化类型：新增属性\n操作类型： POST\n应用场景：客户导入国密SSL证书前，预先生成国密csr文件\n详细描述：\n\n属性名称\n取值类型\n范围\n默认\n操作权限\n约束\n\nKeyPairAlgorithm\nstring\n长度0-64\n“”\nSecurityMgmt\n取值范围:“TPM_ALG_SM2、TPM_ALG_RSA、TPM_ALG_ECC”（遵循Trusted Computing Group Algorithm Registry 标准）\n\n二、rest新增可选参数KeyPairAlgorithm\nuri：/UI/Rest/Services/WEBService/ExportCSR\n变化类型：新增属性\n操作类型：POST\n应用场景：客户导入国密SSL证书前，预先生成国密csr文件\n详细描述：\n\n属性名称\n取值类型\n范围\n默认\n操作权限\n约束\n\nKeyPairAlgorithm\nstring\n长度0-64\n“”\nSecurityMgmt\n取值范围:“TPM_ALG_SM2、TPM_ALG_RSA、TPM_ALG_ECC”（遵循Trusted Computing Group Algorithm Registry 标准）\n\n三、reset新增接口\nuri：/UI/Rest/AccessMgnt/CertMgnt/CertsInformation/GmCerts\n变化类型：新增接口\n操作类型： GET\n应用场景：客户导入国密证书后，查询当前国密证书信息用于web展示\n详细描述：\n\n取值类型\n范围\n默认\n操作权限\n约束\n\nobject\nGET接口返回证书object\n“”\nReadOnly\n返回证书结构体，字段信息准寻x509标准\n\n四、新增资源协作接口GenerateCSR\n资源path：/bmc/kepler/CertificateService\n资源interface：bmc.kepler.CertificateService\n变化类型：新增接口\n应用场景：客户生成csr时用于生成csr文件\n持久化类型： 不持久化\n操作权限：SecurityMgmt\n详细描述：\n\n名称\n变化\n签名\n权限\n持久化\n说明\n约束\n\nGenerateCSR\n新增接口\n请求：ssssssasasia{ss}响应：u\nSecurityMgmt\nNA\nCountry/State/Location/OrgName/OrgUnit/CommonName/AlternativeNames/KeyUsage/KeyBitLength/KeyPairAlgorithm均参考redfish标准定义\n1.KeyPairAlgorithm：生成csr对应使用的密钥对算法，国密取值TPM_ALG_SM2（取值遵循’Trusted Computing Group Algorithm Registry’规范）2.取值范围[0, 64]\n\n四、新增ipmi文件操作类型：国密SSL/CSR文件\n复用文件动作（File Action）ipmi接口\nIPMI命令字：netfn:30h,cmd:93h\n变化类型：新增参数取值\n应用场景：客户生成国密csr文件，以及导入国密SSL证书\n操作类型：SET\n操作角色：Administrator\n操作权限：ReadOnly\nimage659×790 17.6 KB\n评审结论：\n\n同意redfish接口/redfish/v1/CertificateService/Actions/CertificateService.GenerateCSR的POST操作新增参数：KeyPairAlgorithm（可选参数，string类型，长度0~64，取值范围为\"TPM_ALG_RSA\",\"TPM_ALG_ECC\",\"TPM_ALG_SM2\"）\n\n同意webrest接口 /UI/Rest/Services/WEBService/ExportCSR的POST方法新增参数：KeyPairAlgorithm（可选参数，string类型，长度0~64，取值范围为\"TPM_ALG_RSA\",\"TPM_ALG_ECC\",\"TPM_ALG_SM2\"）\n\n同意新增webrest接口：/UI/Rest/AccessMgnt/CertMgnt/CertsInformation/GmCerts，操作类型：GET，权限为ReadOnly，响应体为证书结构化信息\n\n同意复用FileAction命令(netfn:30h,cmd:93h,subcmd=57h)，新增以下文件类型\n0x0D-国密SSL CSR文件(只支持导出）\n0x0E-国密签名SSL CERT证书(只支持导入)\n0x0F-国密加密SSL CERT证书(只支持导入)\n代码实现时需要分别控制每个文件类型的操作权限，资料文档新增表格描述每个文件类型的操作角色/操作权限/支持导入/支持导出属性\n\n同意资源协作接口bmc.kepler.CertificateService新增方法GenerateCSR，SecurityMgmt权限，请求签名ssssssasasia{ss}，响应签名无，参数说明如下：\n\n字段\n类型签名\n描述\n\nCountry\ns\n（必选）两大写字母国家名称(如:CN),对应 RFC5280中 'countryName’字段\n\nState\ns\n省/州，对应 RFC5280中’stateOrProvinceName’字段\n\nCity\ns\n城市/地址，对应 RFC5280中’localityName’字段\n\nOrganization\ns\n公司/组织，对应 RFC5280中’organizationName’字段\n\nOrganizationalUnit\ns\n部门，对应 RFC5280中’organizationalUnitName’字段\n\nCommonName\ns\n（必选）常用名，对应 RFC5280中’commonName’字段\n\nAlternativeNames\nas\nCSR的SAN字段内容，对应 RFC5280中’subjectAltName’字段\n\nKeyUsage\nas\n证书密钥用途\n\nKeyBitLength\ni\n密钥bit长度\n\nOptions\na{ss}\n其余可选配置{“KeyPairAlgorithm” = “TPM_ALG_SM2\"或\"TPM_ALG_RSA\"或\"TPM_ALG_ECC”}\nlinks: #p-1158-issue-1, https://gitcode.com/openUBMC/rackmount/issues/23, #p-1158-h-2, #p-1158-h-3, #p-1158-h-4, #p-1158-redfishkeypairalgorithm-5, #p-1158-restkeypairalgorithm-6, #p-1158-reset-7, #p-1158-generatecsr-8, #p-1158-ipmisslcsr-9, https://discuss.openubmc.cn/uploads/default/original/1X/50f52f1063bc1efd4e4d2530e5edcf51f4f7cf70.png, #p-1158-h-10",
    "topic_user_name": "yanchuanjie",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "huanghan",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/590/2",
            "text": ""
        }
    ]
}