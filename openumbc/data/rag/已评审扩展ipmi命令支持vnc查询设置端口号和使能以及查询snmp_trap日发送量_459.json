{
    "topic_id": 459,
    "question": "【已评审】扩展ipmi命令，支持vnc查询、设置端口号和使能，以及查询snmp trap日发送量 - content: 关联issue\n支持VNC服务启停和端口修改\n支持查询TRAP日发送量\n背景\n客户需要支持查询和设置VNC服务启停状态和端口号，以及查询TRAP日发送量\n决策点\n\n获取服务配置信息的ipmi命令新增表 Service IDs中的参数取值，用于获取vnc的端口号和启停状态\n设置服务配置信息的ipmi命令新增表 Service IDs中的参数取值，用于设置vnc的端口号和启停状态\n新增ipmi命令支持查询TRAP日发送量\n\n详细描述\n1、获取服务配置信息的ipmi命令新增表 Service IDs中的参数取值，用于获取vnc的端口号和使能状态\n命令：netfn：0x30，cmd：0x93， subcmd：0x10\n角色权限：User，操作权限：ReadOnly\n①表 Service IDs中新增参数取值为13，用于表示vnc服务\n表 Service IDs\n\nParameter \n Parameter Data\n\nVNC  \n0x0D\n\n②表 Service parameters中新增Service control，用于表示服务状态，0-stop，1-start\n③表 Service parameters中新增Service port，用于表示端口号\n表 Service parameters\n\nParameter \n Parameter Data\n# (Decimal Format) \n\nService control\nRead and write\n服务状态\n      0-stop\n      1-start\n    \n1\n\nService port\nRead and write\n端口号，小端序\n2\n\n2、对设置服务配置信息的ipmi命令进行扩展，用于设置vnc的端口号和使能状态.扩展信息可见第一点中的表 Service IDs和表 Service parameters中的新增参数\n命令：netfn：0x30，cmd：0x93， subcmd：0x0f\n角色权限：Operator，操作权限：SecurityMgmt\n3、新增ipmi命令支持查询trap日发送量\nIPMI命令字：netfn：0x30，cmd：0x93，subCmd：0x87\n变化类型：新增IPMI命令\n应用场景：获取事件订阅消息统计数据\n操作类型： GET\n角色权限：User\n操作权限：ReadOnly\n参数说明\n\n参数（字节） \n 域内容\n\nNetFn\n30h\n\nCMD\n93h\n\n1:3 \n Manufacturer ID，LS Byte first。长度固定3个字节，例如，某厂家ID是2011，对应十六进制为0x0007DB，则字节序为第1个字节为DBh、第2个字节为07h、第3个字节为00h。\n\n4\nSub command，子命令=0x87h\n\n5 \n Parameter Selector，LS Byte first，参见 表-上报类型配置表\n\n6\nDestinationId，目的端序号取值范围为：0x00~0x03\n\n7:8\nRead Offset，读取的数据偏移，从0开始。\n\n9\n Length，读取长度。\n\n响应说明\n\n字节顺序 \n 域内容\n\n1\nCompletion Code\n\n2:4\nManufacturer ID，LS Byte first。长度固定3个字节，例如，某厂家ID是2011，对应十六进制为0x0007DB，则字节序为第1个字节为DBh、第2个字节为07h、第3个字节为00h.\n\n5 \n End of List\n      表示当前数据是否结束。当参数数据比较长的时候，可能需要分多次读取，通过此字段可以判断数据是否读完.\n      [7:1]：reserved\n      [0]：End of list\n      0=last data\n      1=middle data\n    \n\n6:N\nData，具体数据参见 表-上报类型配置表\n\n表-上报类型配置表\n\n功能描述 \n Parameter Data\n 详细描述\n\nsnmp trap 日发送量\n0x00\n请求:\n      Read Offset: 0x0000\n      Length: 16\n      响应:\n      End of List: 0\n      \nData6~Data9，SuccessCountYesterday，前一天发送成功的次数：\n      Data10~Data13，FailureCountYesterday前一天发送失败的次数：\n      Data14~Data17，SuccessCountToday，当天发送成功的次数：\n      Data18~Data21，FailureCountToday 当天发送失败的次数\n    \n\n评审结论\n1、同意对获取服务配置信息的ipmi命令（netfn：0x30，cmd：0x93， subcmd：0x10）进行扩展，用于获取vnc的端口号和使能状态：表 Service IDs中新增VNC参数，取值为13；表 Service parameters中新增Service control和Service port。\n2、同意对设置服务配置信息的ipmi命令（netfn：0x30，cmd：0x93， subcmd：0x0f）进行扩展，用于设置vnc的端口号和使能状态：表 Service IDs中新增VNC参数，取值为13；表 Service parameters中新增Service control和Service port。\n3、同意新增ipmi命令支持查询trap日发送量，netfn：0x30，cmd：0x93，subCmd：0x87\nlinks: #p-853-issue-1, https://gitcode.com/openUBMC/rackmount/issues/14, https://gitcode.com/openUBMC/rackmount/issues/15, #p-853-h-2, #p-853-h-3, #p-853-h-4, #p-853-h-1ipmi-service-idsvnc-5, #p-853-h-2ipmivnc-service-ids-service-parameters-6, #p-853-h-3ipmitrap-7, #p-853-h-8, #p-853-h-9, #p-853-h-10, #p-853-h-11",
    "topic_user_name": "Zhengzege",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "huanghan",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/459/2",
            "text": ""
        }
    ]
}