{
    "topic_id": 1751,
    "question": "【已评审】支持度量、追踪、日志采集策略配置 - content: 关联ISSUE\n新增指标，跟踪，日志采集策略配置属性-mdb_interface-GitCode\n新增可观测使能开关-mdb_interface-GitCode\n背景\n1、支持跟踪采样和上报策略可配置，包括跟踪采样的系统采样率、系统采样策略、分级采样策略以及上报周期，提供系统级配置和管理能力，并支持配置项动态生效\n（1）跟踪采样率，即系统的固定采样率，当采样率为0时，则表示关闭采样\n（2）跟踪采样策略，支持固定采样策略和自适应采用策略（根据系统负载动态调整跟踪采样率，保证系统性能和业务功能稳定），默认采用固定采样\n（3）跟踪分级策略，跨度创建点分为不同的类型，主要分为Server类型、Client类型、Producer类型、Consumer类型、Internal类型，分级策略将跨度类型分为不同的级别，高级别采样策略覆盖低级别采样策略，包括 1：系统级采样，BMC系统间客户端(Client)到服务端(Server)通信的调用过程 2：组件级采样，组件间客户端(Client、Producer)到服务端(Server、Consumer)通信的调用过程 3：功能级采样，组件内部业务功能(Internal)的调用过程，通过分级策略控制Span（跨度）是否创建。\n（4）跟踪数据上报周期，客户端上报追踪数据到可视化系统的时间间隔，单位s\n2、支持指标采集和上报策略可配置，包括指标采集的上报周期以及各个指标的使能状态，提供系统级配置和管理能力，并支持配置项动态生效\n（1）指标数据上报周期，客户端上报度量指标数据到可视化系统的时间间隔，单位s\n（2）各个指标的使能状态，支持对各个度量指标进行精细化管理，作单独的开启关闭动作\n3、支持日志采集和上报策略可配置，配置项包括日志功能使能以及上报周期，提供系统级配置和管理能力，并支持配置项动态生效\n（1）日志使能开关，日志功能总开关，是否开启日志数据记录与上报功能\n（2）日志数据上报周期，客户端上报日志数据到可视化系统的时间间隔，单位s\n决策点1：persistence服务下新增下列资源协作接口属性\npath: /bmc/kepler/Dashboard\ninterface: bmc.kepler.Dashboard.Observability.Traces\n变化类型：新增资源协作接口及属性\n应用场景 ：用户更改跟踪采样和上报策略\n持久化类型 ：掉电持久化\n操作权限 ：\n读：ReadOnly\n写：DiagnoseMgmt\n\n属性名称\n变化类型\n签名\n读写&权限\n持久化\n变化通知\n接口说明\n接口约束\n\nSamplingRate\n新增属性\nd\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n跟踪采样率，数值精确到小数点后六位，取值范围[0.000000 - 1.000000]，0.000000表示不采样，默认值0.000000\n无\n\nSamplingPolicy\n新增属性\ny\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n跟踪采样策略，取值范围：1：固定概率采样，使用指定的跟踪采样率  2：自适应概率采样，根据cpu自适应调整跟踪采样率，调整范围[0.000000 - 1.000000]。默认值1\n\nSamplingLevel\n新增属性\ny\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n跟踪分级策略， 1：系统级采样，BMC系统间通信的调用过程 2：组件级采样，组件间通信的调用过程 3：功能级采样，组件内部业务功能的调用过程。默认值2\n无\n\nExportIntervalSeconds\n新增属性\nu\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n跟踪数据上报周期，单位s，取值范围[2，60]，默认值5s\n无\n\npath: /bmc/kepler/Dashboard\ninterface: bmc.kepler.Dashboard.Observability.Metrics\n变化类型：新增资源协作接口及属性\n应用场景 ：用户更改指标采集和上报策略\n持久化类型 ：掉电持久化\n操作权限 ：\n读：ReadOnly\n写：DiagnoseMgmt\n\n属性名称\n变化类型\n签名\n读写&权限\n持久化\n变化通知\n接口说明\n接口约束\n\nExportIntervalSeconds\n新增属性\nu\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n指标数据上报周期，单位s，取值范围[5，3600]，默认值30s\n无\n\nActivatedMetrics\n新增属性\nas\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n已使能的指标数组，默认所有指标不使能，即空数组\n无\n\npath: /bmc/kepler/Dashboard\ninterface: bmc.kepler.Dashboard.Observability.Logs\n变化类型：新增资源协作接口及属性\n应用场景 ：用户更改日志采集和上报策略\n持久化类型 ：掉电持久化\n操作权限 ：\n读：ReadOnly\n写：DiagnoseMgmt\n\n属性名称\n变化类型\n签名\n读写&权限\n持久化\n变化通知\n接口说明\n接口约束\n\nEnabled\n新增属性\nb\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n日志使能开关，默认值false\n无\n\nExportIntervalSeconds\n新增属性\nu\nr:ReadOnly;w:DiagnoseMgmt\nPoweroffPer\n是\n日志数据上报周期，单位s，取值范围[2，60]，默认值5s\n无\n\n决策点2：observability服务新增资源协作接口和对应北向接口\n1）observability服务新增资源协作接口\npath: /bmc/kepler/ObservabilityService/Traces（新增）\ninterface: bmc.kepler.ObservabilityService.Traces（新增）\n变化类型：新增资源协作路径、接口、方法\n应用场景 ：用户查询与设置跟踪配置\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\n{“SamplingRate”: “0.5”,     “SamplingPolicy”: “Fixed”,     “SamplingLevel”: “System”,     “ExportIntervalSeconds”: “2”}\nReadOnly\n获取跟踪策略配置\nSamplingRate 跟踪采样率，取值范围：[0.000000,1.000000]SamplingPolicy 跟踪采样策略，取值范围：Fixed（固定采样）或Adaptive（自适应采样）SamplingLevel 跟踪分级策略，取值范围：System（系统级采样）或Component（组件级采样）或Function（功能级采样）ExportIntervalSeconds 跟踪数据上报周期，单位为秒，取值范围：[2,60]\n\nSetConfigurations\n新增方法\na{ss}\n{“SamplingRate”: “0.5”,     “SamplingPolicy”: “Fixed”,     “SamplingLevel”: “System”,     “ExportIntervalSeconds”: “2”}\n—\n—\nDiagnoseMgmt\n设置跟踪策略配置\nSamplingRate 跟踪采样率，取值范围：[0.000000,1.000000]SamplingPolicy 跟踪采样策略，取值范围：Fixed（固定采样）或Adaptive（自适应采样）SamplingLevel 跟踪分级策略，取值范围：System（系统级采样）或Component（组件级采样）或Function（功能级采样）ExportIntervalSeconds 跟踪数据上报周期，单位为秒，取值范围：[2,60]\n\npath: /bmc/kepler/ObservabilityService/Metrics（新增）\ninterface: bmc.kepler.ObservabilityService.Metrics（新增）\n变化类型：新增资源协作路径、接口、属性、方法\n应用场景 ：用户查询与设置度量配置\n\n属性名称\n变化类型\n签名\n读写&权限\n持久化\n变化通知\n说明\n接口约束\n\nSupportedMetrics\n新增属性\nas\nr:ReadOnly\n不持久化\n否\n当前版本支持的度量指标\nbmc启动时从observability.json文件中读取，用户不可修改\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\nMetricsConfig:{“ExportIntervalSeconds”: “2”,     “ActivatedMetrics”: “bmc.hw.chip.io,bmc.hw.chip.accessor” }\nReadOnly\n获取度量策略配置\nExportIntervalSeconds 指标数据上报周期，单位为秒，取值范围：[5,3600]ActivatedMetrics 已使能的指标，取值范围：由SupportedMetrics 决定，当前版本支持\"bmc.hw.chip.io\", “bmc.hw.chip.accessor”,  “bmc.hw.chip.scanner”,  “bmc.mc.flash.io”,  “bmc.rpc.client.request”,  “bmc.persistence.server.request”,  \"bmc.persistence.flash.io\"共七种\n\nSetConfigurations\n新增方法\na{ss}\nMetricsConfig:{ “ExportIntervalSeconds”: “2”,     “ActivatedMetrics”: “bmc.hw.chip.io,bmc.hw.chip.accessor” }\n—\n—\nDiagnoseMgmt\n设置度量策略配置\nExportIntervalSeconds 指标数据上报周期，单位为秒，取值范围：[5,3600]ActivatedMetrics 已使能的指标，取值范围：由SupportedMetrics 决定，当前版本支持\"bmc.hw.chip.io\", “bmc.hw.chip.accessor”,  “bmc.hw.chip.scanner”,  “bmc.mc.flash.io”,  “bmc.rpc.client.request”,  “bmc.persistence.server.request”,  \"bmc.persistence.flash.io\"共七种\n\npath: /bmc/kepler/ObservabilityService/Logs（新增）\ninterface: bmc.kepler.ObservabilityService.Logs（新增）\n变化类型：新增资源协作路径、接口、方法\n应用场景 ：用户查询与设置日志收集配置\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\nLogsConfig: { “Enabled”: “false”,     “ExportIntervalSeconds”: “2”  }\nReadOnly\n获取日志收集策略配置\nEnabled 日志使能开关，取值范围：true或falseExportIntervalSeconds 日志数据上报周期，单位为秒，取值范围：[2,60]\n\nSetConfigurations\n新增方法\na{ss}\nLogsConfig: { “Enabled”: “false”,     “ExportIntervalSeconds”: “2”  }\n—\n—\nDiagnoseMgmt\n设置日志收集策略配置\nEnabled 日志使能开关，取值范围：true或falseExportIntervalSeconds 日志数据上报周期，单位为秒，取值范围：[2,60]\n\n2）web rest接口新增属性\n接口名：/UI/Rest/ObservabilityService\n变化类型：新增属性\n操作类型：GET/PATCH\n应用场景 ：用户更改可观测相关配置\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nTraces\nobject\n\n跟踪采样和上报策略配置\n\nSamplingRate\nnumber\n[0.000000,1.000000]\n0.000000\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样率，[0.000000,1.000000] ，精确到小数点后六位，取值为0.000000时表示跟踪采样和上报使能关闭，GET接口中该属性不可显示为null\n\nSamplingPolicy\nstring\nFixed或Adaptive\nFixed\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样策略，Fixed:固定采样，使用指定的采样率进行采样 Adaptive:自适应采样，根据cpu占用率自适应调整采样率GET接口中该属性不可显示为null\n\nSamplingLevel\nstring\nSystem或Component或Function\nComponent\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪分级策略，System:系统级采样：BMC系统间通信的调用过程 Component :组件级采样：组件间通信的调用过程Function :功能级采样：组件内部业务功能的调用过程GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪数据上报周期，单位为秒GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nMetrics\nobject\n\n度量指标采集策略配置\n\nExportIntervalSeconds\ninterger\n[5,3600]\n30\nGET:ReadOnlyPATCH:DiagnoseMgmt\n度量指标采集周期，单位为秒GET接口中该属性不可显示为null\n\nSupportedMetrics\nstring array\n\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\nGET:ReadOnly\n当前版本支持的各度量指标名称，当前共七个，不支持用户设置\n\nActivatedMetrics\nstring array\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\n默认数组为空\nGET:ReadOnlyPATCH:DiagnoseMgmt\n各度量指标使能开关，根据SupportedMetrics显示支持的度量名称，用户选择需要的度量填入后打开对应度量指标的使能GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nLogs\nobject\n\n日志采集和上报策略配置\n\nEnabled\nBoolean\ntrue或false\nfalse\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报使能开关GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报周期，单位为秒GET接口中该属性不可显示为null\n\nweb接口json格式示例：\n{\n    \"ServiceEnabled\": true,\n    \"TLSMode\": \"TLS\",\n    \"ServerIdentity\": \"ProductAssetTag\",\n    \"Receivers\": [\n        {\n            \"Id\": 0,\n            \"Enabled\": true,\n            \"Address\": \"1.1.1.1\",\n            \"Port\": 6666\n        }\n    ],\n    \"Traces\": {\n        \"SamplingRate\": 0.5,\n        \"SamplingPolicy\": \"Fixed\",\n        \"SamplingLevel\": \"System\",\n        \"ExportIntervalSeconds\": 5\n    },\n    \"Metrics\": {\n        \"ExportIntervalSeconds\": 30,\n        \"SupportedMetrics\": [\n            \"bmc.hw.chip.io\",\n            \"bmc.hw.chip.accessor\", \n            \"bmc.hw.chip.scanner\", \n            \"bmc.mc.flash.io\", \n            \"bmc.rpc.client.request\", \n            \"bmc.persistence.server.request\", \n            \"bmc.persistence.flash.io\"\n        ],\n        \"ActivatedMetrics\": [\n            \"bmc.hw.chip.io\",\n            \"bmc.hw.chip.accessor\", \n            \"bmc.hw.chip.scanner\", \n            \"bmc.mc.flash.io\"\n        ]\n    },\n    \"Logs\": {\n        \"Enabled\": false,\n        \"ExportIntervalSeconds\": 5\n    }\n}\n\n3）redfish接口新增属性\n接口名：/redfish/v1/Oem/{{OemIdentifier}}/ObservabilityService\n变化类型：新增属性\n操作类型：GET/PATCH\n应用场景 ：用户更改可观测相关配置\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nTraces\nobject\n\n跟踪采样和上报策略配置\n\nSamplingRate\nnumber\n[0.000000,1.000000]\n0.000000\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样率，[0.000000,1.000000] ，精确到小数点后六位，取值为0.000000时表示跟踪采样和上报使能关闭GET接口中该属性不可显示为null\n\nSamplingPolicy\nstring\nFixed或Adaptive\nFixed\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样策略，Fixed:固定采样，使用指定的采样率进行采样 Adaptive:自适应采样，根据cpu占用率自适应调整采样率GET接口中该属性不可显示为null\n\nSamplingLevel\nstring\nSystem或Component或Function\nComponent\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪分级策略，System:系统级采样：BMC系统间通信的调用过程 Component :组件级采样：组件间通信的调用过程Function :功能级采样：组件内部业务功能的调用过程GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪数据上报周期，单位为秒GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nMetrics\nobject\n\n度量指标采集策略配置\n\nExportIntervalSeconds\ninterger\n[5,3600]\n30\nGET:ReadOnlyPATCH:DiagnoseMgmt\n度量指标采集周期，单位为秒GET接口中该属性不可显示为null\n\nSupportedMetrics\nstring array\n\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\nGET:ReadOnly\n当前版本支持的各度量指标名称，当前共七个，不支持用户设置\n\nActivatedMetrics\nstring array\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\n默认数组为空\nGET:ReadOnlyPATCH:DiagnoseMgmt\n各度量指标使能开关，根据SupportedMetrics显示支持的度量名称，用户选择需要的度量填入后打开对应度量指标的使能GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nLogs\nobject\n\n日志采集和上报策略配置\n\nEnabled\nBoolean\ntrue或false\nfalse\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报使能开关GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报周期，单位为秒GET接口中该属性不可显示为null\n\nredfish接口json格式示例：\n{\n    \"@odata.context\": \"\",\n    \"@odata.id\": \"\",\n    \"@odata.type\": \"\",\n    \"Id\": \"ObservabilityService\",\n    \"Name\": \"ObservabilityService\",\n    \"ServiceEnabled\": true,\n    \"TLSMode\": \"TLS\",\n    \"ServerIdentity\": \"ProductAssetTag\",\n    \"Receivers\": [\n        {\n            \"ReceiverId\": 0,\n            \"Enabled\": true,\n            \"Address\": \"1.1.1.1\",\n            \"Port\": 6666,\n            \"Protocol\": \"OtlpHttp\"\n        }\n    ],\n    \"Traces\": {\n        \"SamplingRate\": 0.5,\n        \"SamplingPolicy\": \"Fixed\",\n        \"SamplingLevel\": \"System\",\n        \"ExportIntervalSeconds\": 5\n    },\n    \"Metrics\": {\n        \"ExportIntervalSeconds\": 30,\n        \"SupportedMetrics\": [\n            \"bmc.hw.chip.io\",\n            \"bmc.hw.chip.accessor\", \n            \"bmc.hw.chip.scanner\", \n            \"bmc.mc.flash.io\", \n            \"bmc.rpc.client.request\", \n            \"bmc.persistence.server.request\", \n            \"bmc.persistence.flash.io\"\n        ],\n        \"ActivatedMetrics\": [\n            \"bmc.hw.chip.io\",\n            \"bmc.hw.chip.accessor\", \n            \"bmc.hw.chip.scanner\", \n            \"bmc.mc.flash.io\"\n        ]\n    },\n    \"Logs\": {\n        \"Enabled\": false,\n        \"ExportIntervalSeconds\": 5\n    },\n    \"Actions\": {\n        \"#ObservabilityService.SubmitTestTelemetryData\": {\n            \"target\": \"\",\n            \"@Redfish.ActionInfo\": \"\"\n        }\n    }\n}\n\n评审结论\n1. 同意在路径 /bmc/kepler/Dashboard下新增如下可观测功能的资源协作接口，属性\ninterface: bmc.kepler.Dashboard.Observability.Traces\nproperties:\nSamplingRate 表示跟踪采样率，签名为d，读写， 读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\nSamplingPolicy 表示跟踪采样策略，签名为y，读写，读y权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\nSamplingLevel 表示跟踪分级策略，签名为y，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\nExportIntervalSeconds 表示跟踪数据上报周期，签名为u，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\ninterface: bmc.kepler.Dashboard.Observability.Metrics\nproperties:\nExportIntervalSeconds 表示指标数据上报周期，签名为u，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\nActivatedMetrics 表示已使能的指标，签名为as，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\ninterface: bmc.kepler.Dashboard.Observability.Logs\nproperties:\nEnabled 表示日志使能开关，签名为as，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\nExportIntervalSeconds 表示日志数据上报周期，签名为u，读写，读权限：ReadOnly，写权限：DiagnoseMgmt，发送变更通知事件\n2. 同意在observability服务observability服务新增资源协作接口\n(1)\npath: /bmc/kepler/ObservabilityService/Traces（新增）\ninterface: bmc.kepler.ObservabilityService.Traces（新增）\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\n{“SamplingRate”: “0.5”,     “SamplingPolicy”: “Fixed”,     “SamplingLevel”: “System”,     “ExportIntervalSeconds”: “2”}\nReadOnly\n获取跟踪策略配置\nSamplingRate 跟踪采样率，取值范围：[0.000000,1.000000]SamplingPolicy 跟踪采样策略，取值范围：Fixed（固定采样）或Adaptive（自适应采样）SamplingLevel 跟踪分级策略，取值范围：System（系统级采样）或Component（组件级采样）或Function（功能级采样）ExportIntervalSeconds 跟踪数据上报周期，单位为秒，取值范围：[2,60]\n\nSetConfigurations\n新增方法\na{ss}\n{“SamplingRate”: “0.5”,     “SamplingPolicy”: “Fixed”,     “SamplingLevel”: “System”,     “ExportIntervalSeconds”: “2”}\n—\n—\nDiagnoseMgmt\n设置跟踪策略配置\nSamplingRate 跟踪采样率，取值范围：[0.000000,1.000000]SamplingPolicy 跟踪采样策略，取值范围：Fixed（固定采样）或Adaptive（自适应采样）SamplingLevel 跟踪分级策略，取值范围：System（系统级采样）或Component（组件级采样）或Function（功能级采样）ExportIntervalSeconds 跟踪数据上报周期，单位为秒，取值范围：[2,60]\n\n(2)\npath: /bmc/kepler/ObservabilityService/Metrics（新增）\ninterface: bmc.kepler.ObservabilityService.Metrics（新增）\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\nMetricsConfig:{“ExportIntervalSeconds”: “2”,     “ActivatedMetrics”: “bmc.hw.chip.io,bmc.hw.chip.accessor” }\nReadOnly\n获取度量策略配置\nExportIntervalSeconds 指标数据上报周期，单位为秒，取值范围：[5,3600]ActivatedMetrics 已使能的指标，取值范围：由SupportedMetrics 决定，当前版本支持\"bmc.hw.chip.io\", “bmc.hw.chip.accessor”,  “bmc.hw.chip.scanner”,  “bmc.mc.flash.io”,  “bmc.rpc.client.request”,  “bmc.persistence.server.request”,  \"bmc.persistence.flash.io\"共七种\n\nSetConfigurations\n新增方法\na{ss}\nMetricsConfig:{ “ExportIntervalSeconds”: “2”,     “ActivatedMetrics”: “bmc.hw.chip.io,bmc.hw.chip.accessor” }\n—\n—\nDiagnoseMgmt\n设置度量策略配置\nExportIntervalSeconds 指标数据上报周期，单位为秒，取值范围：[5,3600]ActivatedMetrics 已使能的指标，取值范围：由SupportedMetrics 决定，当前版本支持\"bmc.hw.chip.io\", “bmc.hw.chip.accessor”,  “bmc.hw.chip.scanner”,  “bmc.mc.flash.io”,  “bmc.rpc.client.request”,  “bmc.persistence.server.request”,  \"bmc.persistence.flash.io\"共七种\n\n(3)\npath: /bmc/kepler/ObservabilityService/Logs（新增）\ninterface: bmc.kepler.ObservabilityService.Logs（新增）\n\n方法名称\n变化类型\nreq签名\n请求参数\nrsp签名\n响应参数\n权限\n说明\n接口约束\n\nGetConfigurations\n新增方法\n—\n—\na{ss}\nLogsConfig: { “Enabled”: “false”,     “ExportIntervalSeconds”: “2”  }\nReadOnly\n获取日志收集策略配置\nEnabled 日志使能开关，取值范围：true或falseExportIntervalSeconds 日志数据上报周期，单位为秒，取值范围：[2,60]\n\nSetConfigurations\n新增方法\na{ss}\nLogsConfig: { “Enabled”: “false”,     “ExportIntervalSeconds”: “2”  }\n—\n—\nDiagnoseMgmt\n设置日志收集策略配置\nEnabled 日志使能开关，取值范围：true或falseExportIntervalSeconds 日志数据上报周期，单位为秒，取值范围：[2,60]\n\n3. 同意在web rest接口/UI/Rest/ObservabilityService新增属性\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nTraces\nobject\n\n跟踪采样和上报策略配置\n\nSamplingRate\nnumber\n[0.000000,1.000000]\n0.000000\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样率，[0.000000,1.000000] ，精确到小数点后六位，取值为0.000000时表示跟踪采样和上报使能关闭GET接口中该属性不可显示为null\n\nSamplingPolicy\nstring\nFixed或Adaptive\nFixed\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样策略，Fixed:固定采样，使用指定的采样率进行采样 Adaptive:自适应采样，根据cpu占用率自适应调整采样率GET接口中该属性不可显示为null\n\nSamplingLevel\nstring\nSystem或Component或Function\nComponent\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪分级策略，System:系统级采样：BMC系统间通信的调用过程 Component :组件级采样：组件间通信的调用过程Function :功能级采样：组件内部业务功能的调用过程GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪数据上报周期，单位为秒GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nMetrics\nobject\n\n度量指标采集策略配置\n\nExportIntervalSeconds\ninterger\n[5,3600]\n30\nGET:ReadOnlyPATCH:DiagnoseMgmt\n度量指标采集周期，单位为秒GET接口中该属性不可显示为null\n\nSupportedMetrics\nstring array\n\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\nGET:ReadOnly\n当前版本支持的各度量指标名称，当前共七个，不支持用户设置\n\nActivatedMetrics\nstring array\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\n默认数组为空\nGET:ReadOnlyPATCH:DiagnoseMgmt\n各度量指标使能开关，根据SupportedMetrics显示支持的度量名称，用户选择需要的度量填入后打开对应度量指标的使能GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nLogs\nobject\n\n日志采集和上报策略配置\n\nEnabled\nBoolean\ntrue或false\nfalse\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报使能开关GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报周期，单位为秒GET接口中该属性不可显示为null\n\n4. 同意在redfish接口/redfish/v1/Oem/{{OemIdentifier}}/ObservabilityService新增属性\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nTraces\nobject\n\n跟踪采样和上报策略配置\n\nSamplingRate\nnumber\n[0.000000,1.000000]\n0.000000\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样率，[0.000000,1.000000] ，取值为0.000000时表示跟踪采样和上报使能关闭GET接口中该属性不可显示为null\n\nSamplingPolicy\nstring\nFixed或Adaptive\nFixed\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪采样策略，Fixed:固定采样，使用指定的采样率进行采样 Adaptive:自适应采样，根据cpu占用率自适应调整采样率GET接口中该属性不可显示为null\n\nSamplingLevel\nstring\nSystem或Component或Function\nComponent\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪分级策略，System:系统级采样：BMC系统间通信的调用过程 Component :组件级采样：组件间通信的调用过程Function :功能级采样：组件内部业务功能的调用过程GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n跟踪数据上报周期，单位为秒GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nMetrics\nobject\n\n度量指标采集策略配置\n\nExportIntervalSeconds\ninterger\n[5,3600]\n30\nGET:ReadOnlyPATCH:DiagnoseMgmt\n度量指标采集周期，单位为秒GET接口中该属性不可显示为null\n\nSupportedMetrics\nstring array\n\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\nGET:ReadOnly\n当前版本支持的各度量指标名称，当前共七个，不支持用户设置\n\nActivatedMetrics\nstring array\n[“bmc.hw.chip.io”, “bmc.hw.chip.accessor”, “bmc.hw.chip.scanner”, “bmc.mc.flash.io”, “bmc.rpc.client.request”, “bmc.persistence.server.request”, “bmc.persistence.flash.io”]\n默认数组为空\nGET:ReadOnlyPATCH:DiagnoseMgmt\n各度量指标使能开关，根据SupportedMetrics显示支持的度量名称，用户选择需要的度量填入后打开对应度量指标的使能GET接口中该属性不可显示为null\n\n属性名称\n取值类型\n取值范围\n默认值\n操作权限\n说明\n\nLogs\nobject\n\n日志采集和上报策略配置\n\nEnabled\nBoolean\ntrue或false\nfalse\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报使能开关GET接口中该属性不可显示为null\n\nExportIntervalSeconds\ninterger\n[2,60]\n5\nGET:ReadOnlyPATCH:DiagnoseMgmt\n日志采集和上报周期，单位为秒GET接口中该属性不可显示为null\nlinks: #p-4263-issue-1, https://gitcode.com/openUBMC/mdb_interface/issues/171, https://gitcode.com/openUBMC/mdb_interface/issues/170, #p-4263-h-2, #p-4263-h-1persistence-3, #p-4263-h-2observability-4, #p-4263-h-1observability-5, http://bmc.hw.chip.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, #p-4263-h-2web-rest-6, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, #p-4263-h-3redfish-7, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, #p-4263-h-8, http://bmc.hw.chip.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io, http://bmc.hw.chip.io, http://bmc.mc.flash.io, http://bmc.persistence.flash.io",
    "topic_user_name": "chenhongchang",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "许强",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1751/2",
            "text": "dccxgz:\n\nbmc.kepler.Dashboard.Observability.Traces\n\n1、作为接口Traces是否有必要使用复数（建议单数即可）\n2、采样率、采用策略、分级策略、上报周期，都属于跟踪相关的全局配置，不应该区分是System还非System\n3、SamplingPolicy没有准确表达分级策略的含义；取值含义不够清晰，应当准确表达采用的分级，例如组件级、服务级、方法级等；另外取值不利于后续扩展，原则来说，要么取值越大，级别越高，输出越少，或者反之。\n4、上报周期，根据资源协作接口的约定，应当在属性名中体现时间单位"
        },
        {
            "user_name": "chenhongchang",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1751/3",
            "text": "dccxgz:\n\n无\n\nopentelemetry的文档都是写的复数，所以接口就定义成复数了"
        },
        {
            "user_name": "许强",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1751/4",
            "text": "dccxgz:\n\n在persistence服务下新增下列资源协作接口属性\n\n1、新增属性需详细描述属性含义，取值范围，取值的含义，默认值等。\n2、系统采样策略如果采用自适应采样策略，那么会在0到系统采样率之间进行动态调整，这个约束要描述清楚\n3、已经在Traces这个命名空间内，不需要再带上系统的描述，跟踪采样率、跟踪采样策略、跟踪分级策略即可。\n4、跟踪分级策略，还需要考虑下"
        },
        {
            "user_name": "huanghan",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1751/5",
            "text": ""
        }
    ]
}