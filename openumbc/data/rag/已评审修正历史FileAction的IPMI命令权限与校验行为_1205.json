{
    "topic_id": 1205,
    "question": "【已评审】修正历史FileAction的IPMI命令权限与校验行为 - content: ISSUE链接\n\ngitcode.com\n\nGitCode - 全球开发者的开源社区,开源代码托管平台\nGitCode是面向全球开发者的开源社区,包括原创博客,开源代码托管,代码协作,项目管理等。与开发者社区互动,提升您的研发效率和质量。\n\n背景\n历史部分FileAction命令权限与历史版本不一致，需要调整\n决策点\n申请将FileActiong中的命令权限进行如下调整\n整体架构/方案\n不涉及架构变更\n详细描述\nIPMI的命令校验逻辑：\n带外请求：需要用户Role与privilege均满足命令字要求，才可以发送\n带内请求：需要privilege满足命令字要求即可\n带内存在如下通道：\n\nBT通道（此通道无限制）\n带内网管工具通道（此通道受影响，但网管工具IBMA/SP未使用此接口）\nIPMB通道（此通道受影响，IMU器件未使用此接口）\n\n当前FileAction命令权限差别\n证书管理部分：\n\nNetFn\nCMD\nSubCMD\nFilter     data[4]（命令行为）：0-设置；1-查询     data5：1-导出；2-导入     data[6]（文件类型）\n命令行为     查询/导入/导出\n命令说明\n预期role\n预期privilege\n当前role\n当前privilege\n计划调整\n使用场景\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x01,data[6]=0x06\n导出\nSSL CSR\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x07\n导入\nSSL 证书\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x01,data[6]=0x08\n导出\n侯备SSL CSR\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x09\n导入\n侯备SSL 证书\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x0A\n导入\nSSL 证书（带私钥）\n–\n–\nAdministrator\nReadOnly\nSecurityMgmt\n此功能在iBMC5.8.0.1版本提供，为DFX功能，在仅可以访问IPMI接口的场景下，可以导入证书     当前暂未使用\n\nDICE与固件完整性校验部分：\n\nNetFn\nCMD\nSubCMD\nFilter     data[4]（命令行为）：0-设置；1-查询     data5：1-导出；2-导入     data[6]（文件类型）\n命令行为     查询/导入/导出\n命令说明\n预期role\n预期privilege\n当前role\n当前privilege\n计划调整\n使用场景\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x01,data[6]=0x01\n导出\nDICE CSR\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备暂未使用；带内网管工具暂未使用\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x02\n导入\nDICE 证书\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备暂未使用；带内网管工具暂未使用\n\n0x30\n0x93\n0x57\ndata[4]=0x01,data[6]=0x01     预期要求 data[5]=0x01,和设置命令一致，否则返回COMP_CODE_INVALID_CMD     当前仅看data[6]\n查询\nDICE CSR 导出进度\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备暂未使用；带内网管工具暂未使用\n\n0x30\n0x93\n0x57\ndata[4]=0x01,data[6]=0x02     预期要求 data[5]=0x02,和设置命令一致，否则返回COMP_CODE_INVALID_CMD     当前仅看data[6]\n查询\nDICE 证书 导入进度\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备暂未使用；带内网管工具暂未使用\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x03\n导入\n固件完整性校验hash\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x01,data[6]=0x04\n导出\n未签名维修删除凭据的信息\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n0x30\n0x93\n0x57\ndata[4]=0x00,data[5]=0x02,data[6]=0x05\n导入\n签名后维修删除凭据\nAdministrator\nBasicSetting\nAdministrator\nReadOnly\nBasicSetting\n装备场景使用bt通道导入，不影响\n\n变更影响\n\n带外IPMI命令无影响\n带内BT通道无影响\n带内网管工具通道和IPMB通道受影响：\n\n在限制带内接口通信权限为User后（通过Redfish资源：redfish/v1/Managers/1/SecurityService下的IPMIChannelAccess属性进行限制）\n因网管工具和IMU未使用此接口，实际不影响相关工具使用\n\n评审结论\n同意将版本权限调整为上述表格中 <计划调整> 列注明权限\nlinks: #p-2610-issue-1, https://gitcode.com/openUBMC/rackmount/issues/116, https://gitcode.com/openUBMC/rackmount/issues/116, #p-2610-h-2, #p-2610-h-3, #p-2610-h-4, #p-2610-h-5, #p-2610-fileaction-6, #p-2610-h-7, #p-2610-h-8",
    "topic_user_name": "李文杰",
    "best_answer_url": "",
    "reply_posts": []
}