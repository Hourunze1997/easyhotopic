{
    "topic_id": 1439,
    "question": "KVM常见问题定位指导 - content: KVM常见问题定位\n本指南旨在对KVM的常见问题提供定位方向和思路\n1. 上电后KVM界面显示NO SIGNAL\nKVM图像数据是从BMC芯片的VCE寄存器获取的，而VCE寄存器的图像数据是从显卡来的，若KVM未能获取到图像数据（寄存器的图像数据未就绪），则会根据情况显示预置的图像；上电状态下获取图像数据失败，就会显示NO SIGNAL。\n若无图像数据，则有几种可能情况：\n（1）重启或下电再上电后查看串口，确认是否进入OS，若再BIOS等环节卡住需要定位BIOS问题；\n（2）确认CPLD版本，BIOS版本更新并配套；\n（3）在近端VGA口接显示屏查看，KVM从VCE寄存器获取的图像数据与VGA同样来自显卡，若近端显示屏同样无显示，说明数据源头本身就没有图像数据，需要继续定位硬件问题；\n（4）若近端VGA口接显示屏有数据显示，则可能是PCIe建链失败导致的VCE寄存器异常，需要CPLD检查PCIe寄存器情况；\n另可查看一键收集日志中的os日志、linux_kernel_log内核日志，dmesg日志，检查是否有可疑报错。\n2. 远程镜像文件挂载失败或不符合预期\n首先确认VMM使能打开且未被占用：\n然后确认远程服务器上是否有对应的镜像文件；\n需要注意的是，nfs/cifs协议是通过mount命令将目录挂载到BMC进行文件传输的，但是有些nfs/cifs服务器的文件系统是对大小写不敏感的。例如，cifs服务器中同时有CIFSshare目录和CIFSShare目录，但无论挂载url中的路径填写的是CIFSShare还是CIFSshare甚至是cifsshare，时间挂载的目录都是CIFSshare。\n因此请确保你需要挂载的文件在正确的目录下，尽量避免挂载重名目录的情况。\n3. KVM界面键鼠无法输入\n常见情况是USB枚举未下发，可以查看一键收集日志中的dmesg日志，查看最近的os启动时usb device-0连接的日志，是否出现枚举未下发的情况。\n4. 通过VMM本地挂载安装OS用时过长\nVMM本地挂载实际是将本地镜像文件的数据传输到BMC，BMC侧再与USB交互写入数据。因此通过本地挂载安装OS用时会受到BMC网络传输速率的直接影响，所以建议在测试VMM本地挂载安装OS前先测试一下BMC网络传输速率。\n具体可以通过Xftp、scp等工具传输一个约几十MB的文件到BMC的tmp目录，查看文件传输速率是否正常，是否与网口速率有较大区别。\n若发现网络传输速率本身就较慢，可能原因有：\n\n测试人员与服务器环境物理举类过远，建议找与服务器环境在同一地域的测试人员进行测试；\n实验室或机房网络环境本身存在波动；\nBMC网卡模式非专用管理网口；\n\n5. 上电后KVM界面卡住无变化\n首先确认是否确实是图像卡住，还是键鼠输入无响应导致画面未变化，可以查看画面光标是否闪烁，或通过串口切换到OS侧查看是否进入到OS确认；\n若确实进入了OS，但KVM界面图像无变化，可检查hibmc_drm驱动是否加载，未加载可尝试通过modprobe hibmc_drm手动加载确认问题；驱动未加载的问题需要OS领域继续定位。\nlinks: #p-3399-kvm-1, #p-3399-h-1-kvmno-signal-2, #p-3399-h-2-3, #p-3399-h-3-kvm-4, #p-3399-h-4-vmmos-5, #p-3399-h-5-kvm-6",
    "topic_user_name": "Liuyongqi",
    "best_answer_url": "",
    "reply_posts": [
        {
            "user_name": "Huanting",
            "topic_closed": null,
            "is_solution": false,
            "post_url": "/t/topic/1439/2",
            "text": "上电后KVM界面显示NO SIGNAL，但是通过BMC-ssh切入带内后发现OS已经启动，这个是什么问题呢"
        }
    ]
}