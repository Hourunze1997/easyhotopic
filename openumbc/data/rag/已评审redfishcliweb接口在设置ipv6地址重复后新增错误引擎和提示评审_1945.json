{
    "topic_id": 1945,
    "question": "【已评审】redfish/cli/web接口在设置ipv6地址重复后，新增错误引擎和提示评审 - content: ISSUE链接（必填，此议题关联的issue）\n背景\nIPV6异步接口设置IPv6地址时，BMC优先设置本地属性，然后再往协议栈设置，当环境中IP冲突时，IPv6的DAD（重复地址检测）检测失败，协议栈不能使用该地址用作通信，但是BMC记录的本地属性并未恢复，等到IP冲突解除也并未再去尝试设置，因此新做需求，在BMC各个接口设置IPv6地址时，修改本地属性前，先做地址冲突检测，若此地址与其他环境冲突，则此次接口设置IPv6地址返回失败。\n决策点 redfish/cli/web接口在设置ipv6地址重复后，新增错误引擎和提示\n整体架构/方案\n新增IPV6重复地址检测场景，redfish/cli/web接口对该场景新增错误提示\n详细描述\n1）redfish接口uri：\nhttps://device_ip/redfish/v1/Chassis/ipconfig\nhttps://device_ip/redfish/v1/Managers/manager_id/EthernetInterfaces/StaticIp\nhttps://device_ip/redfish/v1/Managers/manager_id/NICs/nicid\n变化类型：新增错误消息\n操作类型：PATCH\n应用场景：调用接口设置IPV6地址\n“DuplicateIPv6Address”: {\n“Description”: “The request for IPv6Address modification failed because the IPv6 address is duplicated.”,\n“Message”: “The request for IPv6Address modification failed because the IPv6 address is duplicated.”,\n“Severity”: “Warning”,\n“NumberOfArgs”: 0,\n“Resolution”: “Change the IPv6 address and try again.”\n}\n2）webrest:https://ip /UI/Rest/BMCSettings/NetworkSettings 新增 ‘操作失败，IPv6地址冲突’\n变化类型：新增错误消息\n操作类型：PATCH\n错误码： code : “DuplicateIPv6Address”\n错误信息：\n‘DuplicateIPv6Address’: {\n‘errorMessage’: ‘操作失败，IPv6地址冲突’\n}\n3）cli设置ipv6地址冲突后，新增错误提示ETH_DUPLICATE_IPV6ADDR  “Set failed, IPv6 address is duplicated.”\n接口：\n设置ipv6地址：ipmcset -d ipaddr6 -v <ipaddr6/prefixlen> [gateway6]\n设置浮动ip: ipmcset [ -l smm ] -d floatipaddr6 -v <ipaddr6/prefixlen> [gateway6]\n变化类型：新增错误消息\n操作类型：SET\n评审结论（评审结束后录入，描述全面且清晰，不能是通过或不通过、同意或不同意）\n1.同意cli新增错误信息，错误信息应修改为：“Set IPv6 address failed, the address is duplicated.”\nlinks: https://ip/",
    "topic_user_name": "Zmy",
    "best_answer_url": "",
    "reply_posts": []
}